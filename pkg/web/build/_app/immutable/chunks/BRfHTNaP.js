import{b as E,h as g,a as A,ae as R,af as q,V as x,E as S,d as T,R as c,ag as k,f as y,ah as z,v as F,ai as N,K as B}from"./d6p2qzFS.js";function V(e,r,...t){var s=e,n=c,i;E(()=>{n!==(n=r())&&(i&&(k(i),i=null),i=T(()=>n(s,...t)))},S),g&&(s=y)}function j(e){return(r,...t)=>{var s=e(...t),n;if(g)n=y,A();else{var i=s.render().trim(),f=R(i);n=z(f),r.before(n)}const u=s.setup?.(n);q(n,n),typeof u=="function"&&x(u)}}function m(e,r,t){if(e==null)return r(void 0),t&&t(void 0),c;const s=F(()=>e.subscribe(r,t));return s.unsubscribe?()=>s.unsubscribe():s}const b=[];function C(e,r){return{subscribe:K(e,r).subscribe}}function K(e,r=c){let t=null;const s=new Set;function n(u){if(N(e,u)&&(e=u,t)){const o=!b.length;for(const a of s)a[1](),b.push(a,e);if(o){for(let a=0;a<b.length;a+=2)b[a][0](b[a+1]);b.length=0}}}function i(u){n(u(e))}function f(u,o=c){const a=[u,o];return s.add(a),s.size===1&&(t=r(n,i)||c),u(e),()=>{s.delete(a),s.size===0&&t&&(t(),t=null)}}return{set:n,update:i,subscribe:f}}function D(e,r,t){const s=!Array.isArray(e),n=s?[e]:e;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=r.length<2;return C(t,(f,u)=>{let o=!1;const a=[];let p=0,d=c;const h=()=>{if(p)return;d();const l=r(s?a[0]:a,f,u);i?f(l):d=typeof l=="function"?l:c},v=n.map((l,_)=>m(l,w=>{a[_]=w,p&=~(1<<_),o&&h()},()=>{p|=1<<_}));return o=!0,h(),function(){B(v),d(),o=!1}})}function G(e){let r;return m(e,t=>r=t)(),r}export{m as a,j as c,D as d,G as g,V as s,K as w};
