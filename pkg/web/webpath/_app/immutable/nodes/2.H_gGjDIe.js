import{bl as as,bm as vn,bn as un,Q as L,j as e,W as c,p as ir,f as i,B as Ua,z as Er,r as s,C as ss,D as Is,v as a,d as t,e as dr,T as xo,a as lr,y as Pr,w as E,g as d,k as j,bo as fn,c as pn,V as _n,x as o,bp as gn,bq as mn,ap as $n,br as hn,bs as xn,bt as bn,bu as yn,bv as Pn,R as ba,ag as pa,P as bo,u as Ur,n as p,a8 as m,i as r,G as A,t as P,s as Hs,Y as b,U as Zt,Z as Rr,X as wn,bw as kn,ac as Ns,aF as Be,a$ as Sn,aZ as zn,b6 as Ha,bf as Ta,bi as Qs,l as ts,bx as io,aH as In,by as Tn,bz as Cn,aG as co,aD as An,aW as vo,bA as uo,bB as Ln,bC as Ca,aL as vs,bD as jn,bE as Mn,bF as Nn,m as yo,F as En,bG as On,bH as Bn,a3 as Po,a2 as wo,a1 as Us,aP as fo,bI as Fn,bJ as Rn,N as Dn,o as Hn,b as Qn,bK as Un,bL as us,bM as qn,bN as Gn,bO as Vn,aK as Wn,a4 as Kn,bP as Jn,bQ as po,bR as Yn}from"../chunks/CtJMHqX4.js";import{a as Tt,s as Ne,R as $a,P as Xn}from"../chunks/CWcMDo9-.js";import{B as X,b as Zn}from"../chunks/Cvi6Ov21.js";import{B as fa}from"../chunks/B2mCoLF1.js";import{T as ko,d as So,e as Xa,R as fs,S as ps,k as Es,a as Os,b as Bs,c as Fs,j as _s,g as gs,h as ms,f as Rs,i as Qr,C as _o}from"../chunks/Dd8QcwO8.js";import{I as da}from"../chunks/CyXrB8cJ.js";import{c as wr,g as el}from"../chunks/ImpKam4h.js";import{a as xs,b as bs,c as ys,d as Ps,e as ws,f as ks,g as Ss,R as zs,B as tl,A as rl,i as go,T as ha,h as xa}from"../chunks/CowMC_2q.js";import{a as Nr}from"../chunks/BiS0q-Mq.js";import{S as La,a as ya,b as Pa,c as Qa,d as ja}from"../chunks/F1JtJdsH.js";import{L as al}from"../chunks/Z1puiL8f.js";import{s as sl}from"../chunks/DXvIg6xT.js";import{s as ol}from"../chunks/CPvYgz4p.js";import{a as mo}from"../chunks/BsLhG3Ea.js";const zo="scn_user_config",nl=as(["fixed","full"]).default("full"),ll=as(["cli","manual"]).default("cli"),il=as(["npm","yarn","pnpm","bun"]).default("pnpm"),dl=as(["class","hex","rgb","hsl","oklch","var"]).default("oklch"),cl=as(["default","scaled","mono","blue","green","amber","rose","purple","orange","teal","violet","red","yellow","neutral"]).default("mono"),$o=vn({layout:nl,installationType:ll,packageManager:il,colorFormat:dl,activeTheme:cl}).default({layout:"full",installationType:"cli",packageManager:"npm",colorFormat:"oklch",activeTheme:"mono"});function vl(y){const l=y.split(";"),f={};for(const $ of l){const[x,C]=$.split("=");f[x]=C}return f}function ul(y){const f=vl(y)[zo];return f?$o.parse(JSON.parse(f)):$o.parse({})}class fl{#e;constructor(l){this.#e=L(l)}get current(){return e(this.#e)}setConfig(l){c(this.#e,{...e(this.#e),...l}),document.cookie=`${zo}=${JSON.stringify(e(this.#e))}; path=/; max-age=31536000; SameSite=Lax;`,l.layout&&pl(e(this.#e).layout)}}function pl(y){typeof document>"u"||(document.documentElement.classList.remove("layout-fixed","layout-full"),document.documentElement.classList.add(`layout-${y}`))}const Io=new un("UserConfigContext"),_l=({data:y})=>({...y,userConfig:ul(document.cookie)}),Gv=Object.freeze(Object.defineProperty({__proto__:null,load:_l},Symbol.toStringTag,{value:"Module"}));var gl=i("<div><!></div>");function Aa(y,l){ir(l,!0);let f=Er(l,["$$slots","$$events","$$legacy","class","children"]);var $=gl();Ua($,C=>({"data-slot":"input-group",role:"group",class:C,...f}),[()=>wr("group/input-group relative flex w-full items-center rounded-md border border-input shadow-xs transition-[color,box-shadow] outline-none dark:bg-input/30","h-9 has-[>textarea]:h-auto","has-[>[data-align=inline-start]]:[&>input]:pl-2","has-[>[data-align=inline-end]]:[&>input]:pr-2","has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3","has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3","has-[[data-slot=input-group-control]:focus-visible]:border-ring has-[[data-slot=input-group-control]:focus-visible]:ring-[3px] has-[[data-slot=input-group-control]:focus-visible]:ring-ring/50","has-[[data-slot][aria-invalid=true]]:border-destructive has-[[data-slot][aria-invalid=true]]:ring-destructive/20 dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40",l.class)]);var x=s($);ss(x,()=>l.children??Is),a($),t(y,$),dr()}const ml=xo({base:"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4",variants:{align:{"inline-start":"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]","inline-end":"order-last pr-3 has-[>button]:mr-[-0.45rem] has-[>kbd]:mr-[-0.35rem]","block-start":"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5","block-end":"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5"}},defaultVariants:{align:"inline-start"}});var $l=i("<div><!></div>");function ma(y,l){ir(l,!0);let f=lr(l,"align",3,"inline-start"),$=Er(l,["$$slots","$$events","$$legacy","class","children","align"]);var x=$l(),C=q=>{q.target.closest("button")||q.currentTarget.parentElement?.querySelector("input")?.focus()};Ua(x,q=>({role:"group","data-slot":"input-group-addon","data-align":f(),class:q,onclick:C,...$}),[()=>wr(ml({align:f()}),l.class)]);var T=s(x);ss(T,()=>l.children??Is),a(x),t(y,x),dr()}const hl=xo({base:"flex items-center gap-2 text-sm shadow-none",variants:{size:{xs:"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5",sm:"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5","icon-xs":"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0","icon-sm":"size-8 p-0 has-[>svg]:p-0"}},defaultVariants:{size:"xs"}});function tr(y,l){ir(l,!0);let f=lr(l,"type",3,"button"),$=lr(l,"variant",3,"ghost"),x=lr(l,"size",3,"xs"),C=Er(l,["$$slots","$$events","$$legacy","class","children","type","variant","size"]);{let T=j(()=>wr(hl({size:x()}),l.class));X(y,Pr({get type(){return f()},get"data-size"(){return x()},get variant(){return $()},get class(){return e(T)}},()=>C,{children:(q,u)=>{var Ye=E(),mt=d(Ye);ss(mt,()=>l.children??Is),t(q,Ye)},$$slots:{default:!0}}))}dr()}function Wa(y,l){ir(l,!0);let f=lr(l,"value",15),$=Er(l,["$$slots","$$events","$$legacy","class","value"]);{let x=j(()=>wr("flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent",l.class));da(y,Pr({"data-slot":"input-group-control",get class(){return e(x)}},()=>$,{get value(){return f()},set value(C){f(C)}}))}dr()}var xl=i("<span><!></span>");function bl(y,l){ir(l,!0);let f=Er(l,["$$slots","$$events","$$legacy","class","children"]);var $=xl();Ua($,C=>({class:C,...f}),[()=>wr("flex items-center gap-2 text-sm text-muted-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4",l.class)]);var x=s($);ss(x,()=>l.children??Is),a($),t(y,$),dr()}var yl=i("<textarea></textarea>");function To(y,l){ir(l,!0);let f=lr(l,"ref",15,null),$=lr(l,"value",15),x=lr(l,"data-slot",3,"textarea"),C=Er(l,["$$slots","$$events","$$legacy","ref","value","class","data-slot"]);var T=yl();fn(T),Ua(T,q=>({"data-slot":x(),class:q,...C}),[()=>wr("flex field-sizing-content min-h-16 w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 md:text-sm dark:bg-input/30 dark:aria-invalid:ring-destructive/40",l.class)]),pn(T,q=>f(q),()=>f()),_n(T,$),t(y,T),dr()}function Pl(y,l){ir(l,!0);let f=lr(l,"value",15),$=lr(l,"ref",15,null),x=Er(l,["$$slots","$$events","$$legacy","class","value","ref"]);{let C=j(()=>wr("flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent",l.class));To(y,Pr({"data-slot":"input-group-control",get class(){return e(C)}},()=>x,{get ref(){return $()},set ref(T){$(T)},get value(){return f()},set value(T){f(T)}}))}dr()}function rs(y,l){ir(l,!0);let f=lr(l,"ref",15,null),$=lr(l,"checked",15,!1),x=Er(l,["$$slots","$$events","$$legacy","ref","class","checked"]);var C=E(),T=d(C);{let q=j(()=>wr("peer inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input dark:data-[state=unchecked]:bg-input/80",l.class));o(T,()=>gn,(u,Ye)=>{Ye(u,Pr({"data-slot":"switch",get class(){return e(q)}},()=>x,{get ref(){return f()},set ref(mt){f(mt)},get checked(){return $()},set checked(mt){$(mt)},children:(mt,rr)=>{var $t=E(),Dt=d($t);{let Lr=j(()=>wr("pointer-events-none block size-4 rounded-full bg-background ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0 dark:data-[state=checked]:bg-primary-foreground dark:data-[state=unchecked]:bg-foreground"));o(Dt,()=>mn,(kr,Pe)=>{Pe(kr,{"data-slot":"switch-thumb",get class(){return e(Lr)}})})}t(mt,$t)},$$slots:{default:!0}}))})}t(y,C),dr()}function Ka(y,l){ir(l,!0);let f=lr(l,"ref",15,null),$=lr(l,"sideOffset",3,4),x=lr(l,"align",3,"center"),C=lr(l,"portalProps",19,()=>({to:".theme-container"})),T=Er(l,["$$slots","$$events","$$legacy","ref","class","sideOffset","align","portalProps"]);var q=E(),u=d(q);o(u,()=>$n,(Ye,mt)=>{mt(Ye,Pr(C,{children:(rr,$t)=>{var Dt=E(),Lr=d(Dt);{let kr=j(()=>wr("z-50 w-72 origin-(--bits-popover-content-transform-origin) rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-hidden data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95",l.class));o(Lr,()=>hn,(Pe,Kt)=>{Kt(Pe,Pr({"data-slot":"popover-content",get sideOffset(){return $()},get align(){return x()},get class(){return e(kr)}},()=>T,{get ref(){return f()},set ref(Ve){f(Ve)}}))})}t(rr,Dt)},$$slots:{default:!0}}))}),t(y,q),dr()}function Ja(y,l){ir(l,!0);let f=lr(l,"ref",15,null),$=Er(l,["$$slots","$$events","$$legacy","ref","class"]);var x=E(),C=d(x);{let T=j(()=>wr("",l.class));o(C,()=>xn,(q,u)=>{u(q,Pr({"data-slot":"popover-trigger",get class(){return e(T)}},()=>$,{get ref(){return f()},set ref(Ye){f(Ye)}}))})}t(y,x),dr()}const Ya=bn,$s=yn;function Ds(y,l){ir(l,!0);let f=lr(l,"ref",15,null),$=lr(l,"data-slot",3,"separator"),x=Er(l,["$$slots","$$events","$$legacy","ref","class","data-slot"]);var C=E(),T=d(C);{let q=j(()=>wr("shrink-0 bg-border data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",l.class));o(T,()=>Pn,(u,Ye)=>{Ye(u,Pr({get"data-slot"(){return $()},get class(){return e(q)}},()=>x,{get ref(){return f()},set ref(mt){f(mt)}}))})}t(y,C),dr()}class wl{#e=L(ba([]));get sets(){return e(this.#e)}set sets(l){c(this.#e,l,!0)}#t=L("idle");get setsStatus(){return e(this.#t)}set setsStatus(l){c(this.#t,l,!0)}#r=L(null);get setsError(){return e(this.#r)}set setsError(l){c(this.#r,l,!0)}#a=L(null);get selectedSetId(){return e(this.#a)}set selectedSetId(l){c(this.#a,l,!0)}#s=L(ba([]));get items(){return e(this.#s)}set items(l){c(this.#s,l,!0)}#o=L("idle");get itemsStatus(){return e(this.#o)}set itemsStatus(l){c(this.#o,l,!0)}#n=L(null);get itemsError(){return e(this.#n)}set itemsError(l){c(this.#n,l,!0)}#l=L("");get setQuery(){return e(this.#l)}set setQuery(l){c(this.#l,l,!0)}#i=L("");get itemQuery(){return e(this.#i)}set itemQuery(l){c(this.#i,l,!0)}#d=L("");get globalQuery(){return e(this.#d)}set globalQuery(l){c(this.#d,l,!0)}#c=L(ba(new pa));get selectedItems(){return e(this.#c)}set selectedItems(l){c(this.#c,l,!0)}#v=L(ba([]));get searchResults(){return e(this.#v)}set searchResults(l){c(this.#v,l,!0)}#u=L("");get importText(){return e(this.#u)}set importText(l){c(this.#u,l,!0)}get filteredItems(){const l=(this.itemQuery||"").trim().toLowerCase(),f=l?this.items.filter($=>$.toLowerCase().includes(l)):this.items;return Array.from(new pa(f))}get filteredSets(){const l=(this.setQuery||"").trim().toLowerCase();return l?this.sets.filter(f=>(f.name||f.id||"").toLowerCase().includes(l)):this.sets}async loadSets(){this.setsStatus="loading",this.setsError=null;try{const f=(await Nr.getAssetSets())?.data,$=f&&typeof f=="object"?f:null,x=Array.isArray(f)?f:Array.isArray($?.items)?$?.items:Array.isArray($?.sets)?$?.sets:[];this.sets=x,this.setsStatus="success"}catch(l){this.setsStatus="error",this.setsError=l instanceof Error?l.message:"加载资产集合失败"}}async selectSet(l){this.selectedSetId=l,this.itemQuery="",await this.loadItems(l)}async loadItems(l){this.itemsStatus="loading",this.itemsError=null,this.items=[],this.selectedItems=new pa;try{const $=(await Nr.getAssetSetItems(l))?.data,x=$&&typeof $=="object"?$:null,C=Array.isArray($)?$:Array.isArray(x?.items)?x?.items:[];this.items=C.filter(T=>typeof T=="string"),this.itemsStatus="success"}catch(f){this.itemsStatus="error",this.itemsError=f instanceof Error?f.message:"加载集合条目失败"}}toggleSelect(l){const f=new pa(this.selectedItems);f.has(l)?f.delete(l):f.add(l),this.selectedItems=f}clearSelection(){this.selectedItems=new pa}selectAllFiltered(){const l=new pa(this.selectedItems);for(const f of this.filteredItems)l.add(f);this.selectedItems=l}invertSelectionFiltered(){const l=new pa(this.selectedItems);for(const f of this.filteredItems)l.has(f)?l.delete(f):l.add(f);this.selectedItems=l}async importToSelected(l={dedupe:!0,normalize:!0}){if(!this.selectedSetId)throw new Error("未选择集合");const f=(this.importText||"").split(/\r?\n/).map(C=>C.trim()).filter(Boolean).join(`
`);if(!f)return{added:0,skipped:0};const $={content:f,options:{dedupe:l.dedupe,normalize:l.normalize}},x=await Nr.importIntoAssetSet(this.selectedSetId,$);return await this.loadItems(this.selectedSetId),this.importText="",x.data||{added:0,skipped:0}}async createSet(l,f){const $=(f?.content??"").split(/\r?\n/).map(q=>q.trim()).filter(Boolean).join(`
`),x={name:l,category:f?.category,tags:f?.tags,content:$,options:{dedup:!0,normalize:!0}},C=await Nr.createAssetSet(x);await this.loadSets();const T=C?.data?.id;return T&&await this.selectSet(T),C}async deleteSelectedSet(){this.selectedSetId&&(await Nr.deleteAssetSet(this.selectedSetId),this.selectedSetId=null,await this.loadSets(),this.items=[])}async search(l){this.globalQuery=l;const $=(await Nr.searchAssets(l))?.data,x=$&&typeof $=="object"?$:null,C=Array.isArray($)?$:Array.isArray(x?.items)?x?.items:[];this.searchResults=C.filter(T=>typeof T=="string")}}const ie=new wl;var kl=i("<!> <!> <!>",1),Sl=i('<span class="text-xs text-muted-foreground"> </span>'),zl=i('<div class="flex items-center justify-between border-b px-4 py-3"><!> <div class="flex items-center gap-2"><!> <!></div></div>'),Il=i('<div class="space-y-3 p-4"><div class="flex items-center justify-between gap-2"><div class="flex items-center gap-2"><!> <!></div> <div class="text-xs text-muted-foreground"> </div></div> <!> <div class="flex items-center gap-2"><!> <!></div></div>'),Tl=i("<!> <!>",1),Cl=i("<!> <!>",1),Al=i("<!> <!>",1),Ll=i("<!> <!>",1),jl=i('<div class="p-3 text-xs text-muted-foreground">加载中...</div>'),Ml=i('<div class="p-3 text-xs text-destructive"> </div>'),Nl=i('<div class="p-3 text-xs text-muted-foreground">暂无集合</div>'),El=i('<button><div class="truncate text-xs"> </div> <!></button>'),Ol=i("<!> <!> <!>",1),Bl=i('<div class="p-3 text-xs text-muted-foreground">加载中...</div>'),Fl=i('<div class="p-3 text-xs text-destructive"> </div>'),Rl=i('<div class="p-3 text-xs text-muted-foreground">暂无条目</div>'),Dl=i('<label class="flex items-center gap-2 border-t px-3 py-1 text-sm"><input type="checkbox"/> <span class="truncate"> </span></label>'),Hl=i("<!> <!> <!>",1),Ql=i('<div class="flex min-h-0 flex-1"><div class="flex w-64 flex-col border-r"><div class="flex items-center justify-between p-3"><div class="text-xs">集合</div> <div class="flex items-center gap-2"><!> <!></div></div> <!> <div class="space-y-2 border-t p-3"><!> <div class="flex items-center gap-2"></div></div></div> <div class="flex min-h-0 flex-1 flex-col"><div class="border-b p-3 text-xs"><div class="flex items-center justify-between gap-2"><div> </div> <div class="flex items-center gap-2"><!> <!> <!> <!></div></div></div> <!></div></div>'),Ul=i('<span class="text-xs text-muted-foreground"> </span>'),ql=i('<div class="p-3 text-xs text-muted-foreground">暂无结果</div>'),Gl=i('<div class="truncate border-t px-3 py-1"> </div>'),Vl=i('<div class="text-sm"></div>'),Wl=i("<!> <!> <!>",1),Kl=i('<div class="space-y-3 p-4"><div class="flex items-center gap-2"><!> <!> <!> <!></div> <div class="rounded border"><!></div></div>'),Jl=i('<div class="flex h-[var(--assets-height)] flex-col"><!> <!></div>');function Yl(y,l){ir(l,!0);let f=lr(l,"height",3,"60vh"),$=lr(l,"onAdd",3,()=>{}),x=L("import"),C=L(!1),T=L(!1),q=L(null);const u=j(()=>(ie.importText||"").split(/\r?\n/)),Ye=j(()=>e(u).map(pe=>pe.trim()).filter(Boolean)),mt=j(()=>Array.from(new Set(e(Ye))));Ur(()=>{ie.loadSets()});function rr(){if(e(T))return;const pe=Array.from(ie.selectedItems);if(pe.length===0){c(q,"请选择条目");return}c(T,!0);try{$()(pe),c(q,`已添加 ${pe.length} 条`),setTimeout(()=>c(q,null),2e3)}finally{c(T,!1)}}async function $t(){const pe=await navigator.clipboard.readText().catch(()=>"");ie.importText=pe}function Dt(){const pe=(ie.importText||"").split(/\r?\n/).map(ze=>ze.trim()).filter(Boolean),vt=Array.from(new Set(pe));ie.importText=vt.join(`
`)}async function Lr(){await ie.importToSelected({dedupe:!0,normalize:!0})}async function kr(){const pe=prompt("新集合名称");pe&&(await ie.createSet(pe,{content:ie.importText}),ie.importText="",c(x,"history"))}async function Pe(){await ie.deleteSelectedSet(),c(C,!1)}async function Kt(){const pe=(ie.globalQuery||"").trim();pe&&(await ie.search(pe),c(x,"search"))}var Ve=Jl(),Ut=s(Ve);o(Ut,()=>ko,(pe,vt)=>{vt(pe,{get value(){return e(x)},set value(ze){c(x,ze,!0)},children:(ze,ut)=>{var Ct=zl(),At=s(Ct);o(At,()=>So,(yt,vr)=>{vr(yt,{children:(Pt,Cr)=>{var Sr=kl(),Or=d(Sr);o(Or,()=>Xa,(Br,qr)=>{qr(Br,{value:"import",children:(jr,at)=>{p();var qt=m("导入");t(jr,qt)},$$slots:{default:!0}})});var Zr=r(Or,2);o(Zr,()=>Xa,(Br,qr)=>{qr(Br,{value:"history",children:(jr,at)=>{p();var qt=m("集合");t(jr,qt)},$$slots:{default:!0}})});var sa=r(Zr,2);o(sa,()=>Xa,(Br,qr)=>{qr(Br,{value:"search",children:(jr,at)=>{p();var qt=m("搜索");t(jr,qt)},$$slots:{default:!0}})}),t(Pt,Sr)},$$slots:{default:!0}})});var bt=r(At,2),lt=s(bt);X(lt,{size:"sm",onclick:rr,get disabled(){return e(T)},children:(yt,vr)=>{p();var Pt=m("添加到资产列表");t(yt,Pt)},$$slots:{default:!0}});var er=r(lt,2);{var sr=yt=>{var vr=Sl(),Pt=s(vr,!0);a(vr),P(()=>b(Pt,e(q))),t(yt,vr)};A(er,yt=>{e(q)&&yt(sr)})}a(bt),a(Ct),t(ze,Ct)},$$slots:{default:!0}})});var cr=r(Ut,2);{var ar=pe=>{var vt=Il(),ze=s(vt),ut=s(ze),Ct=s(ut);X(Ct,{size:"sm",variant:"ghost",onclick:$t,children:(Pt,Cr)=>{p();var Sr=m("从剪贴板导入");t(Pt,Sr)},$$slots:{default:!0}});var At=r(Ct,2);X(At,{size:"sm",variant:"ghost",onclick:Dt,children:(Pt,Cr)=>{p();var Sr=m("去重与清理");t(Pt,Sr)},$$slots:{default:!0}}),a(ut);var bt=r(ut,2),lt=s(bt);a(bt),a(ze);var er=r(ze,2);To(er,{rows:12,class:"h-[260px] w-full resize-none",get value(){return ie.importText},set value(Pt){ie.importText=Pt}});var sr=r(er,2),yt=s(sr);{let Pt=j(()=>!ie.importText.trim());X(yt,{size:"sm",onclick:kr,get disabled(){return e(Pt)},children:(Cr,Sr)=>{p();var Or=m("保存为新集合");t(Cr,Or)},$$slots:{default:!0}})}var vr=r(yt,2);{let Pt=j(()=>!ie.selectedSetId||!ie.importText.trim());X(vr,{size:"sm",variant:"outline",onclick:Lr,get disabled(){return e(Pt)},children:(Cr,Sr)=>{p();var Or=m("追加到当前集合");t(Cr,Or)},$$slots:{default:!0}})}a(sr),a(vt),P(()=>b(lt,`行数 ${e(u).length??""} · 非空 ${e(Ye).length??""} · 去重 ${e(mt).length??""}`)),t(pe,vt)},Ht=pe=>{var vt=E(),ze=d(vt);{var ut=At=>{var bt=Ql(),lt=s(bt),er=s(lt),sr=r(s(er),2),yt=s(sr);X(yt,{size:"sm",variant:"ghost",onclick:()=>ie.loadSets(),children:(Lt,ea)=>{p();var ur=m("刷新");t(Lt,ur)},$$slots:{default:!0}});var vr=r(yt,2);o(vr,()=>zs,(Lt,ea)=>{ea(Lt,{get open(){return e(C)},set open(ur){c(C,ur,!0)},children:(ur,Na)=>{var Vr=Ll(),or=d(Vr);{let zr=j(()=>!ie.selectedSetId);X(or,{size:"sm",variant:"ghost",get disabled(){return e(zr)},onclick:()=>c(C,!0),children:(Qt,Jt)=>{p();var Gt=m("删除");t(Qt,Gt)},$$slots:{default:!0}})}var $r=r(or,2);o($r,()=>xs,(zr,Qt)=>{Qt(zr,{children:(Jt,Gt)=>{var nr=Al(),jt=d(nr);o(jt,()=>bs,(pr,hr)=>{hr(pr,{children:(xr,Wr)=>{var oa=Tl(),ta=d(oa);o(ta,()=>ys,(Yt,Vt)=>{Vt(Yt,{children:(br,na)=>{p();var Ir=m("确认删除");t(br,Ir)},$$slots:{default:!0}})});var ca=r(ta,2);o(ca,()=>Ps,(Yt,Vt)=>{Vt(Yt,{children:(br,na)=>{p();var Ir=m("删除后不可恢复，是否删除当前集合？");t(br,Ir)},$$slots:{default:!0}})}),t(xr,oa)},$$slots:{default:!0}})});var fr=r(jt,2);o(fr,()=>ws,(pr,hr)=>{hr(pr,{children:(xr,Wr)=>{var oa=Cl(),ta=d(oa);o(ta,()=>ks,(Yt,Vt)=>{Vt(Yt,{children:(br,na)=>{p();var Ir=m("取消");t(br,Ir)},$$slots:{default:!0}})});var ca=r(ta,2);o(ca,()=>Ss,(Yt,Vt)=>{Vt(Yt,{onclick:Pe,children:(br,na)=>{p();var Ir=m("删除");t(br,Ir)},$$slots:{default:!0}})}),t(xr,oa)},$$slots:{default:!0}})}),t(Jt,nr)},$$slots:{default:!0}})}),t(ur,Vr)},$$slots:{default:!0}})}),a(sr),a(er);var Pt=r(er,2);o(Pt,()=>ja,(Lt,ea)=>{ea(Lt,{class:"flex-1",children:(ur,Na)=>{var Vr=Ol(),or=d(Vr);o(or,()=>La,(Qt,Jt)=>{Jt(Qt,{class:"h-full",children:(Gt,nr)=>{var jt=E(),fr=d(jt);{var pr=xr=>{var Wr=jl();t(xr,Wr)},hr=xr=>{var Wr=E(),oa=d(Wr);{var ta=Yt=>{var Vt=Ml(),br=s(Vt,!0);a(Vt),P(()=>b(br,ie.setsError)),t(Yt,Vt)},ca=Yt=>{var Vt=E(),br=d(Vt);{var na=Ar=>{var Kr=Nl();t(Ar,Kr)},Ir=Ar=>{var Kr=E(),wa=d(Kr);Zt(wa,17,()=>ie.filteredSets,_a=>_a.id,(_a,Dr)=>{var Jr=El();Jr.__click=()=>ie.selectSet(e(Dr).id);var ra=s(Jr),Ea=s(ra,!0);a(ra);var h=r(ra,2);fa(h,{variant:"outline",class:"h-5",children:(ka,qs)=>{p();var os=m();P(()=>b(os,e(Dr).line_count??0)),t(ka,os)},$$slots:{default:!0}}),a(Jr),P(()=>{Rr(Jr,1,`flex w-full items-center justify-between border-t px-3 py-2 text-left ${ie.selectedSetId===e(Dr).id?"bg-muted":""}`),b(Ea,e(Dr).name)}),t(_a,Jr)}),t(Ar,Kr)};A(br,Ar=>{ie.sets.length===0?Ar(na):Ar(Ir,!1)},!0)}t(Yt,Vt)};A(oa,Yt=>{ie.setsStatus==="error"?Yt(ta):Yt(ca,!1)},!0)}t(xr,Wr)};A(fr,xr=>{ie.setsStatus==="loading"?xr(pr):xr(hr,!1)})}t(Gt,jt)},$$slots:{default:!0}})});var $r=r(or,2);o($r,()=>ya,(Qt,Jt)=>{Jt(Qt,{orientation:"vertical",children:(Gt,nr)=>{var jt=E(),fr=d(jt);o(fr,()=>Pa,(pr,hr)=>{hr(pr,{})}),t(Gt,jt)},$$slots:{default:!0}})});var zr=r($r,2);o(zr,()=>Qa,(Qt,Jt)=>{Jt(Qt,{})}),t(ur,Vr)},$$slots:{default:!0}})});var Cr=r(Pt,2),Sr=s(Cr);da(Sr,{placeholder:"搜索集合",class:"h-8",get value(){return ie.setQuery},set value(Lt){ie.setQuery=Lt}}),p(2),a(Cr),a(lt);var Or=r(lt,2),Zr=s(Or),sa=s(Zr),Br=s(sa),qr=s(Br);a(Br);var jr=r(Br,2),at=s(jr);da(at,{class:"h-8",placeholder:"筛选条目",get value(){return ie.itemQuery},set value(Lt){ie.itemQuery=Lt}});var qt=r(at,2);X(qt,{size:"sm",variant:"outline",onclick:()=>{ie.itemQuery=""},children:(Lt,ea)=>{p();var ur=m("清空筛选");t(Lt,ur)},$$slots:{default:!0}});var Gr=r(qt,2);X(Gr,{size:"sm",variant:"outline",onclick:()=>ie.selectAllFiltered(),children:(Lt,ea)=>{p();var ur=m("全选");t(Lt,ur)},$$slots:{default:!0}});var Ma=r(Gr,2);X(Ma,{size:"sm",variant:"ghost",onclick:()=>ie.clearSelection(),children:(Lt,ea)=>{p();var ur=m("清空选择");t(Lt,ur)},$$slots:{default:!0}}),a(jr),a(sa),a(Zr);var qa=r(Zr,2);o(qa,()=>ja,(Lt,ea)=>{ea(Lt,{class:"flex-1",children:(ur,Na)=>{var Vr=Hl(),or=d(Vr);o(or,()=>La,(Qt,Jt)=>{Jt(Qt,{class:"h-full",children:(Gt,nr)=>{var jt=E(),fr=d(jt);{var pr=xr=>{var Wr=Bl();t(xr,Wr)},hr=xr=>{var Wr=E(),oa=d(Wr);{var ta=Yt=>{var Vt=Fl(),br=s(Vt,!0);a(Vt),P(()=>b(br,ie.itemsError)),t(Yt,Vt)},ca=Yt=>{var Vt=E(),br=d(Vt);{var na=Ar=>{var Kr=Rl();t(Ar,Kr)},Ir=Ar=>{var Kr=E(),wa=d(Kr);Zt(wa,19,()=>ie.filteredItems,(_a,Dr)=>_a+":"+Dr,(_a,Dr)=>{var Jr=Dl(),ra=s(Jr);wn(ra),ra.__change=()=>ie.toggleSelect(e(Dr));var Ea=r(ra,2),h=s(Ea,!0);a(Ea),a(Jr),P(ka=>{kn(ra,ka),b(h,e(Dr))},[()=>ie.selectedItems.has(e(Dr))]),t(_a,Jr)}),t(Ar,Kr)};A(br,Ar=>{ie.filteredItems.length===0?Ar(na):Ar(Ir,!1)},!0)}t(Yt,Vt)};A(oa,Yt=>{ie.itemsStatus==="error"?Yt(ta):Yt(ca,!1)},!0)}t(xr,Wr)};A(fr,xr=>{ie.itemsStatus==="loading"?xr(pr):xr(hr,!1)})}t(Gt,jt)},$$slots:{default:!0}})});var $r=r(or,2);o($r,()=>ya,(Qt,Jt)=>{Jt(Qt,{orientation:"vertical",children:(Gt,nr)=>{var jt=E(),fr=d(jt);o(fr,()=>Pa,(pr,hr)=>{hr(pr,{})}),t(Gt,jt)},$$slots:{default:!0}})});var zr=r($r,2);o(zr,()=>Qa,(Qt,Jt)=>{Jt(Qt,{})}),t(ur,Vr)},$$slots:{default:!0}})}),a(Or),a(bt),P(()=>b(qr,`条目 · ${ie.filteredItems.length??""}`)),t(At,bt)},Ct=At=>{var bt=E(),lt=d(bt);{var er=sr=>{var yt=Kl(),vr=s(yt),Pt=s(vr);da(Pt,{class:"h-9",placeholder:"跨集合搜索（按地址匹配）",get value(){return ie.globalQuery},set value(at){ie.globalQuery=at}});var Cr=r(Pt,2);X(Cr,{size:"sm",onclick:Kt,children:(at,qt)=>{p();var Gr=m("搜索");t(at,Gr)},$$slots:{default:!0}});var Sr=r(Cr,2);X(Sr,{size:"sm",onclick:()=>{if(!e(T)){c(T,!0);try{const at=ie.searchResults;at.length===0?c(q,"暂无可添加条目"):($()(at),c(q,`已添加 ${at.length} 条`),setTimeout(()=>c(q,null),2e3))}finally{c(T,!1)}}},get disabled(){return e(T)},children:(at,qt)=>{p();var Gr=m("添加到资产列表");t(at,Gr)},$$slots:{default:!0}});var Or=r(Sr,2);{var Zr=at=>{var qt=Ul(),Gr=s(qt,!0);a(qt),P(()=>b(Gr,e(q))),t(at,qt)};A(Or,at=>{e(q)&&at(Zr)})}a(vr);var sa=r(vr,2),Br=s(sa);{var qr=at=>{var qt=ql();t(at,qt)},jr=at=>{var qt=E(),Gr=d(qt);o(Gr,()=>ja,(Ma,qa)=>{qa(Ma,{class:"max-h-[45vh]",children:(Lt,ea)=>{var ur=Wl(),Na=d(ur);o(Na,()=>La,($r,zr)=>{zr($r,{children:(Qt,Jt)=>{var Gt=Vl();Zt(Gt,23,()=>ie.searchResults,(nr,jt)=>nr+":"+jt,(nr,jt)=>{var fr=Gl(),pr=s(fr,!0);a(fr),P(()=>b(pr,e(jt))),t(nr,fr)}),a(Gt),t(Qt,Gt)},$$slots:{default:!0}})});var Vr=r(Na,2);o(Vr,()=>ya,($r,zr)=>{zr($r,{orientation:"vertical",children:(Qt,Jt)=>{var Gt=E(),nr=d(Gt);o(nr,()=>Pa,(jt,fr)=>{fr(jt,{})}),t(Qt,Gt)},$$slots:{default:!0}})});var or=r(Vr,2);o(or,()=>Qa,($r,zr)=>{zr($r,{})}),t(Lt,ur)},$$slots:{default:!0}})}),t(at,qt)};A(Br,at=>{ie.searchResults.length===0?at(qr):at(jr,!1)})}a(sa),a(yt),t(sr,yt)};A(lt,sr=>{e(x)==="search"&&sr(er)},!0)}t(At,bt)};A(ze,At=>{e(x)==="history"?At(ut):At(Ct,!1)},!0)}t(pe,vt)};A(cr,pe=>{e(x)==="import"?pe(ar):pe(Ht,!1)})}a(Ve),P(()=>Hs(Ve,`--assets-height: ${f()};`)),t(y,Ve),dr()}bo(["click","change"]);function Xl(y,l,f){c(l,!0);try{y.currentTarget?.setPointerCapture?.(y.pointerId)}catch{}y.preventDefault(),y.stopPropagation();const $=C=>f(C.clientY),x=()=>{c(l,!1),window.removeEventListener("pointermove",$),window.removeEventListener("pointerup",x)};window.addEventListener("pointermove",$),window.addEventListener("pointerup",x,{once:!0}),f(y.clientY)}var Zl=i('<div class="flex min-w-0 items-center gap-2"><div></div> <span class="max-w-[120px] truncate text-xs font-medium"> </span></div>'),ei=i('<div class="size-2 rounded-full bg-muted"></div> <span class="text-xs">Idle</span>',1),ti=i('<span class="ml-0.5 size-1.5 animate-pulse rounded-full bg-destructive" title="后台任务发现高危漏洞"></span>'),ri=i('<span class="relative flex h-1.5 w-1.5"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"></span> <span class="relative inline-flex h-1.5 w-1.5 rounded-full bg-primary"></span></span> <span class="text-[10px]"> </span> <!>',1),ai=(y,l,f)=>l(e(f).id),si=i('<span class="font-bold text-destructive"> </span>'),oi=i('<button class="flex w-full items-center justify-between rounded-sm px-2 py-1.5 text-left text-xs transition-colors hover:bg-accent hover:text-accent-foreground"><div class="flex min-w-0 flex-1 items-center gap-2"><div class="size-1.5 shrink-0 rounded-full bg-primary"></div> <div class="truncate font-medium"> </div></div> <div class="flex items-center gap-2 text-muted-foreground"><!> <span> </span></div></button>'),ni=i('<div class="border-b bg-muted/30 p-2 text-xs font-medium text-muted-foreground">后台运行任务</div> <div class="max-h-[300px] overflow-y-auto p-1"></div>',1),li=i("<!> <!>",1),ii=i('<div class="text-xs text-muted-foreground">加载中…</div>'),di=i('<div class="text-xs text-muted-foreground">未发现可用实例</div>'),ci=i('<div class="text-xs text-muted-foreground"> </div>'),vi=i('<div class="flex items-start justify-between gap-2 rounded-md border p-2"><div class="space-y-1"><div class="text-sm"> </div> <div class="text-xs text-muted-foreground"> </div> <!></div> <div class="flex items-center gap-2"><!></div></div>'),ui=i('<div class="space-y-3 p-4"><div class="text-sm font-medium">选择要强制关闭的实例</div> <div class="text-xs text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <!> <!></div> <div class="space-y-2"><!></div></div>'),fi=i('<span class="flex items-center gap-1 font-bold text-destructive"><div class="size-1.5 rounded-full bg-destructive"></div> </span>'),pi=i('<span class="flex items-center gap-1 font-bold text-orange-500"><div class="size-1.5 rounded-full bg-orange-500"></div> </span>'),_i=i('<span class="flex items-center gap-1 text-yellow-500"><div class="size-1.5 rounded-full bg-yellow-500"></div> </span>'),gi=i('<span class="flex items-center gap-1 text-sky-500"><div class="size-1.5 rounded-full bg-sky-500"></div> </span>'),mi=i('<span class="text-muted-foreground/50">无漏洞发现</span>'),$i=i('<div class="flex items-center gap-3 font-mono text-xs"><!> <!> <!> <!> <!></div> <div class="flex w-48 items-center gap-2"><div class="h-1.5 w-full overflow-hidden rounded-full bg-muted"><div class="h-full bg-primary transition-all duration-500 ease-out"></div></div> <div class="w-8 text-right font-mono text-[10px] text-muted-foreground"> </div></div>',1),hi=i('<!> <span class="sr-only">展开面板</span>',1),xi=i('<span class="text-sm">任务</span>'),bi=i('<div class="flex items-center gap-1"><!></div>'),yi=(y,l,f)=>l(e(f).id),Pi=(y,l,f)=>{y.stopPropagation(),l(e(f).id)},wi=i('<div class="group relative"><button><div class="flex min-w-0 items-center gap-2"><div></div> <div class="max-w-[140px] min-w-0 truncate text-xs"> </div></div> <div class="flex items-center gap-1 transition-opacity group-hover:opacity-0"><div class="text-xs text-muted-foreground"> </div></div></button> <button class="hover:text-destructive-foreground absolute top-1/2 right-1 hidden h-6 w-6 -translate-y-1/2 items-center justify-center rounded-sm text-muted-foreground transition-colors group-hover:flex hover:bg-destructive" title="删除任务"><!></button></div>'),ki=i("<!> <!> <!>",1),Si=(y,l,f)=>l(e(f).id),zi=i('<button><span></span> <span class="ms-2 text-[11px] tracking-wide text-muted-foreground"> </span></button>'),Ii=i("<!> <!> <!>",1),Ti=i('<span data-slot="select-value" class="truncate"> </span>'),Ci=i("<!> <!> <!> <!> <!> <!>",1),Ai=i("<!> <!>",1),Li=i("<!> <!>",1),ji=i("<!> <!>",1),Mi=i('<div class="flex h-full flex-col items-center justify-center py-10 text-muted-foreground opacity-50"><!> <p>暂无活动日志</p></div>'),Ni=i('<span class="opacity-70">OOB</span> <span> </span>',1),Ei=i('<div class="flex items-center justify-between rounded bg-black/20 px-2 py-1"><span class="opacity-70"> </span> <span class="font-mono font-bold"> <!></span></div>'),Oi=i('<div class="mt-3 border-t border-primary-foreground/20 pt-2"><div class="mb-1.5 text-[10px] opacity-70">阶段进度</div> <div class="grid grid-cols-2 gap-2 text-[10px]"></div></div>'),Bi=i('<div class="flex items-center gap-2"><div class="size-1 shrink-0 rounded-full bg-primary-foreground/40"></div> <span class="truncate"></span></div>'),Fi=i('<div class="pl-3 text-[9px] opacity-50"> </div>'),Ri=i('<div class="mt-3 border-t border-primary-foreground/20 pt-2"><div class="mb-1.5 flex items-center justify-between text-[10px] opacity-70"><span>目标列表</span> <span class="opacity-50"><!></span></div> <div class="flex flex-col gap-1.5 rounded-md bg-black/20 p-2 font-mono text-[10px] break-all opacity-90"><!> <!></div></div>'),Di=i('<span class="shrink-0 font-mono text-[10px] text-muted-foreground"> </span>'),Hi=i('<div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div></div></div> <div class="flex shrink-0 items-center gap-2"><!> <span class="text-[10px] text-muted-foreground opacity-70"> </span></div></div>'),Qi=i('<div class="min-w-[260px] overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm"><div class="flex items-center justify-between gap-3 border-b bg-muted/30 px-3 py-2"><div class="flex min-w-0 items-center gap-2"><!> <span class="truncate text-sm font-medium">主机发现</span> <span class="text-xs text-muted-foreground"> </span></div> <!></div> <div class="max-h-[240px] overflow-auto bg-background p-3"><div class="flex flex-col gap-2 font-mono text-xs break-all select-text"></div></div></div>'),Ui=i('<div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div></div></div> <div class="flex shrink-0 items-center gap-2"><!> <span class="text-[10px] text-muted-foreground opacity-70"> </span></div></div>'),qi=i('<div class="min-w-[260px] overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm"><div class="flex items-center justify-between gap-3 border-b bg-muted/30 px-3 py-2"><div class="flex min-w-0 items-center gap-2"><!> <span class="truncate text-sm font-medium">端口探测结果</span> <span class="text-xs text-muted-foreground"> </span></div></div> <div class="max-h-[240px] overflow-auto bg-background p-3"><div class="flex flex-col gap-2 font-mono text-xs break-all select-text"></div></div></div>'),Gi=i('<div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div></div></div> <div class="flex shrink-0 items-center gap-2"><!> <span class="text-[10px] text-muted-foreground opacity-70"> </span></div></div>'),Vi=i('<div class="min-w-[260px] overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm"><div class="flex items-center justify-between gap-3 border-b bg-muted/30 px-3 py-2"><div class="flex min-w-0 items-center gap-2"><!> <span class="truncate text-sm font-medium">Web 指纹探测结果</span> <span class="text-xs text-muted-foreground"> </span></div></div> <div class="max-h-[240px] overflow-auto bg-background p-3"><div class="flex flex-col gap-2 font-mono text-xs break-all select-text"></div></div></div>'),Wi=i('<div class="min-w-[260px] rounded-2xl rounded-tr-sm bg-primary p-4 text-sm leading-relaxed text-primary-foreground shadow-sm"><div class="mb-3 flex items-center gap-2 border-b border-primary-foreground/20 pb-2 font-bold"><!> <span>任务已启动</span></div> <div class="grid grid-cols-2 gap-x-6 gap-y-2 text-xs"><span class="opacity-70">目标数量</span> <span class="text-right font-mono font-bold"> </span> <span class="opacity-70">PoC 数量</span> <span class="text-right font-mono font-bold"> </span> <span class="opacity-70">预计扫描</span> <span class="text-right font-mono font-bold"> </span> <!></div> <!> <!></div> <!> <!> <!>',1),Ki=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">CRITICAL</span> <span class="font-mono font-bold text-red-300"> </span></div>'),Ji=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">HIGH</span> <span class="font-mono font-bold text-orange-300"> </span></div>'),Yi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">MEDIUM</span> <span class="font-mono font-bold text-yellow-300"> </span></div>'),Xi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">LOW</span> <span class="font-mono font-bold text-blue-300"> </span></div>'),Zi=i('<div class="flex flex-col items-center rounded bg-black/20 p-1.5"><span class="text-[10px] opacity-70">INFO</span> <span class="font-mono font-bold text-gray-300"> </span></div>'),ed=i('<div class="py-1 text-center text-[10px] opacity-50">未发现漏洞</div>'),td=i('<div class="mt-3 border-t border-primary-foreground/20 pt-2"><div class="mb-2 text-[10px] opacity-70">漏洞统计</div> <div class="grid grid-cols-3 gap-2 text-xs"><!> <!> <!> <!> <!></div> <!></div>'),rd=i('<div class="min-w-[260px] rounded-2xl rounded-tr-sm bg-primary p-4 text-sm leading-relaxed text-primary-foreground shadow-sm"><div class="mb-3 flex items-center gap-2 border-b border-primary-foreground/20 pb-2 font-bold"><!> <span>扫描已完成</span></div> <div class="grid grid-cols-2 gap-x-6 gap-y-2 text-xs"><span class="opacity-70">总耗时</span> <span class="text-right font-mono font-bold"> </span> <span class="opacity-70">总请求</span> <span class="text-right font-mono font-bold"> </span></div> <!></div>'),ad=i('<div class="rounded-2xl rounded-tr-sm bg-primary px-4 py-2.5 text-sm leading-relaxed text-primary-foreground shadow-sm"><span class="break-all"></span></div>'),sd=i('<div class="flex max-w-[65%] animate-in flex-col items-end gap-1 self-end duration-300 fade-in slide-in-from-bottom-2"><!> <span class="pr-1 font-mono text-[10px] text-muted-foreground opacity-70"> </span></div>'),od=i('<span class="select-none"> </span>'),nd=i('<div class="flex max-w-[90%] animate-in flex-col items-start gap-1 self-start duration-300 fade-in slide-in-from-bottom-2"><div class="flex gap-3"><div class="mt-1 flex size-8 shrink-0 items-center justify-center rounded-full border border-primary/10 bg-primary/10 text-primary shadow-sm"><!></div> <div class="flex min-w-0 flex-col gap-1"><div class="min-w-[300px] overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm"><div class="flex items-center justify-between gap-3 border-b bg-muted/30 px-3 py-2"><div class="flex min-w-0 items-center gap-2"><!> <span class="truncate text-sm font-medium"><span></span></span></div> <!></div> <div class="bg-background p-3 font-mono text-xs break-all select-text"><div></div></div></div> <div class="flex items-center gap-2 pl-1 font-mono text-[10px] text-muted-foreground opacity-70"><!> <span> </span></div></div></div></div>'),ld=i('<span class="mr-1 font-bold">ERROR:</span>'),id=i('<div class="flex max-w-[85%] animate-in flex-col items-start gap-1 self-start duration-300 fade-in slide-in-from-bottom-2"><div><!> <span class="break-all"></span></div> <span class="pl-1 font-mono text-[10px] text-muted-foreground opacity-70"> </span></div>'),dd=i('<div class="flex flex-col gap-4 pb-4"><!></div>'),cd=i("<!> <!> <!>",1),vd=i('<div class="mt-0.5 text-[11px] leading-4 text-muted-foreground"> </div>'),ud=i("<div> </div> <!>",1),fd=i("<!> <!>",1),pd=i('<div class="rounded-md border border-destructive/20 bg-destructive/10 px-2 py-1 text-xs text-destructive"> </div> <div class="flex items-center gap-2"><!></div>',1),_d=i('<div class="space-y-2"><div class="text-sm">确认暂停当前任务？</div> <!> <div class="flex items-center gap-2"><!> <!></div></div>'),gd=i("<!> <!>",1),md=i('<!> <span class="sr-only">继续</span>',1),$d=i("<!> <!>",1),hd=i('<!> <span class="sr-only">停止</span>',1),xd=i('<div class="rounded-md border border-destructive/20 bg-destructive/10 px-2 py-1 text-xs text-destructive"> </div> <div class="flex items-center gap-2"><!></div>',1),bd=i('<div class="space-y-2"><div class="text-sm">确认停止当前任务？</div> <!> <div class="flex items-center gap-2"><!> <!></div></div>'),yd=i("<!> <!>",1),Pd=i("<!> <!>",1),wd=i("<!> <!> <!> <!>",1),kd=i("<!> <!>",1),Sd=y=>y.preventDefault(),zd=(y,l,f)=>l(e(f)),Id=i('<button><div class="truncate"> </div> <!></button>'),Td=i('<div class="relative w-64"><!> <!></div> <!>',1),Cd=i("<!> <!>",1),Ad=i("<!> <!>",1),Ld=i("<!> <!>",1),jd=i("<!> <!>",1),Md=i("<!> <!> <!> <!> <!> <!>",1),Nd=i("<!> <!>",1),Ed=i("<!> <!>",1),Od=i('<div class="pointer-events-auto fixed inset-x-0 bottom-0 z-[60]"><div class="container mx-auto max-w-[1400px] px-4"><div><div class="absolute top-0 right-0 left-0 z-10 h-3 cursor-[ns-resize] touch-none bg-transparent"><div class="mx-auto mt-0.5 h-1 w-14 rounded-full bg-muted-foreground/60"></div></div> <div class="flex h-full"><div><div><!> <!></div> <!></div> <div class="flex flex-1 flex-col"><div class="flex items-center justify-between border-b-0 px-4 py-2"><div class="flex items-center gap-2"><!> <!> <!></div> <div class="flex items-center gap-2"><span class="text-xs text-muted-foreground">跟随滚动</span> <!> <div class="ml-2 flex items-center gap-0.5 border-l pl-2"><!> <!></div></div></div> <!> <div class="flex flex-col gap-3 border-t-0 px-4 py-3"><!></div></div></div></div></div></div>'),Bd=i("<!> <!>",1),Fd=i('<span data-slot="select-value" class="truncate"> </span>'),Rd=i('<span class="text-muted-foreground"> </span>'),Dd=i("<!> <!>",1),Hd=i("<!> <!>",1),Qd=i("<!> <!>",1),Ud=i("<!> <!>",1),qd=i("<!> <!>",1),Gd=i("<!> <!> <!> <!> <!>",1),Vd=i("<!> 保存",1),Wd=i("<!> <!> <!>",1),Kd=i("<!> <!>",1),Jd=i("<!> <!>",1),Yd=i("<!> <!>",1),Xd=i("<!> <!>",1),Zd=i("<!> <!>",1),ec=i("<!> <!>",1),tc=i("<!> <!>",1),rc=i("<!> <!>",1),ac=i('<div class="grid grid-cols-[200px_1fr] items-center gap-3"><div class="flex items-center gap-2"><!> <label class="text-xs text-muted-foreground" for="perf-smart">智能并发 (--smart)</label></div></div> <div class="grid grid-cols-[140px_1fr] items-start gap-3"><div class="flex items-start gap-6"><div class="space-y-2"><div class="text-xs text-muted-foreground">每秒请求上限 (-rl)</div> <!></div> <div class="space-y-2"><div class="text-xs text-muted-foreground">并发上限 (-c)</div> <!></div></div></div> <div class="space-y-2"><label class="text-xs text-muted-foreground" for="perf-timeout">超时秒数 (--timeout)</label> <!></div> <div class="space-y-2"><label class="text-xs text-muted-foreground" for="perf-retries">重试次数 (--retries)</label> <!></div> <div class="space-y-3"><div class="text-xs text-muted-foreground">探测</div> <div class="grid gap-3 md:grid-cols-2"><div class="flex items-center gap-2"><!> <label class="text-xs text-muted-foreground" for="perf-web-fingerprint">Web 指纹探测 (-w)</label></div> <div class="flex items-center gap-2"><!> <label class="text-xs text-muted-foreground" for="perf-port-scan">端口探测 (-ps)</label></div> <div class="space-y-2 md:col-span-2"><label class="text-xs text-muted-foreground" for="perf-ports">端口 (-p)</label> <!></div> <div class="flex items-center gap-2 md:col-span-2"><!> <label class="text-xs text-muted-foreground" for="perf-skip-host-discovery">跳过主机探测 (-Pn)</label></div></div></div>',1),sc=i('<div class="flex items-center gap-2"><!> <!></div>'),oc=i('<span data-slot="select-value"> </span>'),nc=i("<!> <!>",1),lc=i("<!> <!>",1),ic=i('<div class="flex items-center gap-2"><!> <span class="text-xs capitalize"> </span></div>'),dc=i('<div class="grid gap-3 md:grid-cols-2"><div class="space-y-2"><label class="text-xs text-muted-foreground" for="http-proxy">代理 (--proxy)</label> <!></div> <div class="space-y-2 md:col-span-2"><div class="text-xs text-muted-foreground">附加头部 (-H)</div> <div class="flex flex-col gap-2"><!> <div><!></div></div></div> <div class="space-y-2"><label class="text-xs text-muted-foreground" for="http-sort">排序 (--sort)</label> <!></div> <div class="space-y-2 md:col-span-2"><div class="text-xs text-muted-foreground">漏洞等级 (-S)</div> <div class="flex flex-wrap items-center gap-4"></div></div></div>'),cc=i('<span data-slot="select-value"> </span>'),vc=i("<!> <!> <!> <!> <!>",1),uc=i("<!> <!>",1),fc=i("<!> <!>",1),pc=i("<!> <!>",1),_c=i("<!> <!>",1),gc=i("<!> <!>",1),mc=i('<div class="space-y-4"><div class="space-y-2"><div class="text-xs text-muted-foreground">适配器 (--oob)</div> <!></div> <div class="grid grid-cols-[140px_1fr] items-start gap-3"><div class="flex items-start gap-6"><div class="space-y-2"><div class="text-xs text-muted-foreground">OOB 请求速率 (-orl)</div> <!></div> <div class="space-y-2"><div class="text-xs text-muted-foreground">OOB 并发上限 (-oc)</div> <!></div></div></div></div>'),$c=i('<!> <!> <!> <div class="mt-4 space-y-2"><div class="text-xs text-muted-foreground">命令预览（仅包含变更项）</div> <div class="rounded-md border bg-muted p-3 text-xs"> </div> <div class="flex items-center gap-2"><!></div></div>',1),hc=i("<!> <!>",1),xc=i("<!> <!>",1),bc=i('<div class="container mx-auto max-w-[1400px] px-4"><!> <div class="flex items-center justify-between gap-2 py-2"><!> <!></div> <!></div>'),yc=i("<!> <!>",1),Pc=i("<!> <!>",1),wc=i('<div class="px-3 py-2 text-xs text-muted-foreground">请输入关键词搜索</div>'),kc=(y,l,f)=>l(e(f)),Sc=(y,l,f)=>{y.key==="Enter"&&l(e(f))},zc=i('<div role="button" tabindex="0" class="flex w-full items-center justify-between border-t px-3 py-2"><div class="flex items-center gap-2"><!> <span class="truncate text-xs"> </span> <!></div> <div class="flex items-center gap-2"><span class="text-xs text-muted-foreground"> </span> <!></div></div>'),Ic=i('<div class="flex items-center justify-between border-b px-3 py-2"><div class="flex items-center gap-2"><span class="truncate text-xs"> </span> <!></div> <!></div>'),Tc=i('<div class="px-3 py-2 text-xs text-muted-foreground">未选择 PoC（默认扫描全部）</div>'),Cc=i('<div class="container mx-auto max-w-[1400px] px-4"><!> <div class="grid grid-cols-2 gap-4 py-2"><div class="space-y-2"><div class="flex items-center gap-2"><!> <!> <!> <!> <!></div> <div class="max-h-[60vh] overflow-auto rounded border"><!></div> <div class="flex items-center justify-between py-2"><div class="text-xs text-muted-foreground"> </div> <div class="flex items-center gap-2"><!> <div class="text-xs"> </div> <!> <div class="flex items-center gap-1"><!> <!></div></div></div></div> <div class="space-y-2"><div class="flex items-center justify-between"><div class="text-sm"> </div> <!></div> <div class="max-h-[60vh] overflow-auto rounded border"><!></div></div></div></div>'),Ac=i("<!> <!>",1),Lc=i("<!> <!>",1),jc=i('<div class="container mx-auto max-w-[1400px] px-4"><!> <!></div>'),Mc=i("<!> <!>",1),Nc=i("<!> <!>",1),Ec=i("<!> <!>",1),Oc=i("<!> <!>",1),Bc=i("<!> <!>",1),Fc=i("<!> <!>",1),Rc=i("<!> <!>",1),Dc=i("<!> <!>",1),Hc=i("<!> <!>",1),Qc=i('<div class="pointer-events-none fixed right-0 bottom-0 left-0 z-50"><div class="container mx-auto max-w-[1400px] px-4"><div class="pointer-events-auto flex h-9 items-center justify-between rounded-t-md border bg-card px-1 text-card-foreground shadow-sm"><div class="flex min-w-0 flex-1 items-center gap-2 px-2"><!> <!> <!></div> <div class="flex items-center gap-6 px-4"><!></div> <div class="flex items-center gap-1 px-1"><!></div></div></div> <!> <!> <!> <!> <!> <!></div>');function Uc(y,l){ir(l,!0);let f=j(()=>Ne.expanded),$=j(()=>Ne.panelSnap);const x=["critical","high","medium","low","info"],C=ba({critical:!1,high:!1,medium:!1,low:!1,info:!1});let T=!1;const q=j(()=>x.filter(n=>C[n]));Ur(()=>{const n=e(h).http.severity??[];T=!0;for(const v of x)C[v]=n.includes(v);T=!1}),Ur(()=>{if(T)return;const n=e(q),v=e(h).http.severity??[];v.length===n.length&&v.every((w,U)=>w===n[U])||(e(h).http.severity=n)});let u=j(()=>Ne.activeTask),Ye=j(()=>Ne.tasks),mt=j(()=>e(u)?Ne.logs[e(u).id]||[]:[]),rr=j(()=>e(u)?(Ne.logs[e(u).id]||[]).filter(n=>n.label==="PORT"):[]),$t=j(()=>e(u)?(Ne.logs[e(u).id]||[]).filter(n=>n.label==="WEBPROBE"):[]),Dt=j(()=>e(u)?(Ne.logs[e(u).id]||[]).filter(n=>n.label==="HOST"):[]);const Lr=["host_discovery","portscan","webprobe","vuln"],kr={host_discovery:"主机发现",portscan:"端口扫描",webprobe:"Web 探测",vuln:"漏洞扫描"};let Pe=L(""),Kt=L(void 0);Ur(()=>{if(e(u)?.id===e(Kt))return;c(Kt,e(u)?.id,!0);const n=(e(u)?.targets||[]).filter(Boolean);c(Pe,n.length>0?n.join(`
`):e(u)?.target||"",!0)}),Ur(()=>{ie.loadSets()});let Ve=L(""),Ut=L(null),cr=L(null),ar=L(null),Ht=L(!1),pe=L(!1),vt=L(!1),ze=L(0);const ut=j(()=>{const n=(e(Ve)||"").trim().toLowerCase();return n?(ie.sets||[]).filter(v=>((v.name||v.id||"")+"").toLowerCase().includes(n)):[]});function Ct(n){Promise.resolve().then(()=>ie.loadItems(n.id)).then(()=>{c(Pe,(ie.items||[]).join(`
`),!0),c(pe,!1),c(Ve,(n.name||n.id||"")+"")}).catch(()=>{})}Ur(()=>{const n=!!(e(Ve)||"").trim();c(pe,!!e(vt)&&n,!0),e(ze)>=e(ut).length&&c(ze,0)}),Ur(()=>{if(!e(pe)||!e(ar))return;const n=e(ze);Ns().then(()=>{e(ar)?.querySelector(`button[data-asset-set-index="${n}"]`)?.scrollIntoView({block:"nearest"})})});let At=j(()=>(e(Pe)||"").split(/\r?\n/).map(n=>n.trim()).filter(Boolean).length),bt=j(()=>(e(Pe)||"").split(/\r?\n/).map(n=>n.trim()).filter(Boolean)),lt=j(()=>e(bt).length===0?"":e(bt)[0]);function er(){const n=(e(Pe)||"").split(/\r?\n/).map(w=>w.trim()).filter(Boolean),v=Array.from(new pa(n));c(Pe,v.join(`
`),!0)}function sr(n){if(typeof n!="string")return;const v=n.toLowerCase().trim();return x.includes(v)?v:void 0}let yt=L(!1);async function vr(){if(e(yt))return;const n=(e(Pe)||"").split(/\r?\n/).map(U=>U.trim()).filter(Boolean).join(`
`);if(!n){Be.error("内容为空");return}const w=(prompt("新集合名称",e(lt)||"新集合")||"").trim();if(w){c(yt,!0);try{await ie.createSet(w,{content:n}),c(Ve,w,!0),Be.success(`已保存为新集合：${w}`)}catch{Be.error("保存失败")}finally{c(yt,!1)}}}let Pt=j(()=>e(Ye).filter(n=>n.id!==e(u)?.id&&(n.status==="running"||n.status==="starting"))),Cr=j(()=>e(Pt).length),Sr=j(()=>e(Pt).some(n=>(n.severityStats?.critical??0)>0||(n.severityStats?.high??0)>0)),Or=j(()=>e(u)?.severityStats?.critical??0),Zr=j(()=>e(u)?.severityStats?.high??0),sa=j(()=>e(u)?.severityStats?.medium??0),Br=j(()=>e(u)?.severityStats?.low??0),qr=L(!0),jr=L(null),at=L("all"),qt=L("");function Gr(n){if(n.type!=="info")return!1;const v=n.text||"";return v.includes("开始")||v.includes("暂停")||v.includes("停止")||v.includes("选择")||v.includes("User")||v.includes("Loading")||v.includes("Scan Started")||v.includes("Scan Completed")||v.includes("Scan Created")||v.includes("Targets:")||v.includes("OOB:")||v.includes("使用 PoC")}let Ma=j(()=>(e(mt)||[]).filter(n=>n.type==="hit"?e(at)==="all"?!0:Ks(n)===e(at):!!(n.type==="error"||Gr(n))).filter(n=>{const v=e(qt).trim();return v?[n.pocName||"",n.url||"",n.text||"",n.label||""].join(" ").toLowerCase().includes(v.toLowerCase()):!0}));Ur(()=>{const n=e(Ma).length;e(qr)&&e(jr)&&n>=0&&Ns().then(()=>{e(jr).scrollTop=e(jr).scrollHeight})});let qa=L(!1),Lt=L(!1);function ea(n){const v=window.innerHeight,w=Math.max(.3,Math.min(1,(v-n)/v));Ne.setPanelSnap(w)}function ur(){Ne.setPanelExpanded(!0)}function Na(){Ne.setPanelExpanded(!1)}function Vr(){c(Lt,!e(Lt))}let or=L(!1),$r=L(!1),zr=L(!1),Qt=L(!1),Jt=L(""),Gt=L(""),nr=L(!1),jt=L(!1),fr=L(!1),pr=L(ba([])),hr=L("");Ur(()=>{e(jt)&&ca()});async function xr(){if(!e($r)){c($r,!0),c(Jt,"");try{const n=String(e(u)?.serverTaskId||e(u)?.id||"");if(!n)throw new Error("未找到任务标识");const v=await Nr.pauseScan(n);if(!!v?.success&&!!v.data?.paused)e(u)&&Ne.pause(e(u).id),Be.success("已暂停");else{const U=String(v?.message||"暂停失败");c(Jt,U,!0),Be.error(U)}}catch(n){const v=n instanceof Error?n.message:"暂停失败";c(Jt,v,!0),Be.error(v)}finally{c($r,!1)}}}async function Wr(){if(!e(zr)){c(zr,!0);try{const n=String(e(u)?.serverTaskId||e(u)?.id||"");if(!n)throw new Error("未找到任务标识");const v=await Nr.resumeScan(n);if(!!v?.success&&!!v.data?.resumed)e(u)&&Ne.resume(e(u).id),Be.success("已继续");else{const U=String(v?.message||"继续失败");Be.error(U)}}catch(n){const v=n instanceof Error?n.message:"继续失败";Be.error(v)}finally{c(zr,!1)}}}async function oa(){if(!e(Qt)){c(Qt,!0),c(Gt,"");try{const n=String(e(u)?.serverTaskId||e(u)?.id||"");if(!n)throw new Error("未找到任务标识");const v=await Nr.stopScan(n);if(!!v?.success&&!!v.data?.stopped)e(u)&&Ne.cancel(e(u).id),Be.success("已停止");else{const U=String(v?.message||"停止失败");c(Gt,U,!0),Be.error(U)}}catch(n){const v=n instanceof Error?n.message:"停止失败";c(Gt,v,!0),Be.error(v)}finally{c(Qt,!1)}}}async function ta(n){c(jt,!0)}async function ca(){c(fr,!0);try{const n=await Nr.listInstances();c(pr,Array.isArray(n?.data?.instances)?n.data.instances:[],!0);const v=String(e(u)?.serverInstanceId||""),w=e(pr).find(Xe=>Xe.instance_id===v),U=e(pr).find(Xe=>Xe.base_url===String(e(u)?.serverBaseUrl||""));c(hr,String((w||U||e(pr)[0]||{instance_id:""}).instance_id||""),!0)}catch(n){Be.error(n instanceof Error?n.message:"加载实例失败")}finally{c(fr,!1)}}async function Yt(){if(!e(hr)){Be.error("请选择实例");return}c(nr,!0);try{const n=String(e(u)?.serverTaskId||e(u)?.id||""),v=await Nr.listInstances(),U=(Array.isArray(v?.data?.instances)?v.data.instances:[]).find(Ra=>Ra.instance_id===e(hr));if(!U){Be.error("实例不存在或已关闭"),c(nr,!1);return}const Xe=Array.isArray(U.active_task_ids)?U.active_task_ids:[];if(!n||!Xe.includes(n)){Be.error("所选实例不包含当前任务，请选择正确实例或刷新"),c(nr,!1);return}const _r=await Nr.forceStopInstance(e(hr),{taskId:n,confirm:!0});!!_r?.success&&!!_r.data?.stopped?(e(u)&&Ne.cancel(e(u).id),c(Jt,""),c(Gt,""),c(jt,!1),Be.success("已强制关闭实例")):Be.error(String(_r?.message||"强制关闭失败"))}catch(n){Be.error(n instanceof Error?n.message:"强制关闭失败")}finally{c(nr,!1)}}function Vt(){const n=Ne.createTask();Ne.setActiveTask(n)}function br(n){Ne.setActiveTask(n)}function na(n){return n.split(/\r?\n/).map(v=>v.trim()).filter(Boolean)}let Ir=L(!1),Ar=L("敏感操作确认"),Kr=L("当前目标包含内网或启用 OOB，是否继续？"),wa,_a=[],Dr=L(!1),Jr=L(!1),ra=L(!1),Ea=L("performance"),h=L(ba(Tt.mergeWithBaseline({})));Ur(()=>{Tt.load();const n=Tt.getActiveMerged();(!n.http.headers||n.http.headers.length===0)&&(n.http.headers=[""]),c(h,n,!0)});function ka(){c(h,Tt.getActiveMerged(),!0),(!e(h).http.headers||e(h).http.headers.length===0)&&(e(h).http.headers=[""])}function qs(n){Tt.setActive(n),ka()}function os(){const n=Tt.create("新策略");Tt.setActive(n),ka();const v=Tt.getActive();Be.success(`已新建策略：${v?.name||n}`)}function Ao(){const n=Tt.getActive();if(!n){Be.error("请先选择策略");return}const v=Tt.duplicate(n.id);if(v){Tt.setActive(v),ka();const w=Tt.getActive();Be.success(`已复制策略为：${w?.name||v}`)}else Be.error("复制失败")}function Lo(){const n=Tt.getActive();if(!n){Be.error("未选择策略");return}Tt.remove(n.id),ka(),Be.success(`已删除策略：${n.name}`)}function jo(){e(h).http.headers=(e(h).http.headers||[]).map(n=>(n||"").trim()).filter(n=>n.length>0),Tt.saveActive(e(h)),(!e(h).http.headers||e(h).http.headers.length===0)&&(e(h).http.headers=[""]),Be.success("策略已保存")}function Mo(){const n=e(Ye).find(v=>v.status==="running"||v.status==="starting"||v.status==="paused");n&&Ne.setActiveTask(n.id),ur()}async function No(){if(c(Ir,!1),wa)await wa();else{if(e(or))return;e(u)&&(c(or,!0),Ne.begin(e(u).id,_a).then(()=>{setTimeout(()=>c(or,!1),150)}).catch(()=>{c(or,!1)}))}}const Eo=async()=>{if(!e(or)){try{const n=new AbortController,v=setTimeout(()=>n.abort(),2e3),w=await Nr.getServerInfo({signal:n.signal});if(clearTimeout(v),w.success&&w.data){const{memory_usage:U=0,cpu_usage:Xe=0,active_task_count:_r=0}=w.data;if(_r>=4){Be.error(`当前并发任务数已达浏览器连接池上限 (${_r}/4)。为防止界面卡死，请等待现有任务完成后再试。`);return}const ia=U>80||Xe>90,Ra=_r>=5;if(ia||Ra){c(Ar,"系统负载过高"),c(Kr,`当前系统负载较高 (内存: ${U.toFixed(1)}%, 任务数: ${_r})。继续创建任务可能会导致扫描速度变慢或不稳定。是否确认继续？`),wa=async()=>{await Ts()},c(Ir,!0);return}}}catch(n){const v=n instanceof Error?n.name:"",w=n instanceof Error?n.message:"";if(v==="AbortError"||w==="timeout"){c(Ar,"系统响应超时"),c(Kr,"获取系统状态超时 (超过2s)，当前系统负载可能极高。继续创建任务可能会导致严重卡顿。是否确认继续？"),wa=async()=>{await Ts()},c(Ir,!0);return}console.error("Failed to check server status",n)}await Ts()}},Ts=async()=>{const n=na(e(Pe)||"");if(n.length===0){Be.error("请先输入资产目标"),c(Ht,!0),setTimeout(()=>e(cr)?.focus(),50);return}Tt.getActiveMerged(),c(or,!0);try{const v=(e(u)?.pocs||[]).slice();let w="";e(u)&&e(u).status==="idle"?w=e(u).id:w=Ne.tasks.find(Xe=>Xe.status==="idle")?.id||"";const U=w||Ne.createTask("New Scan");if(Ne.setActiveTask(U),v.length)for(const Xe of v)Ne.addTaskPoc(U,{id:Xe.id,name:Xe.name,severity:Xe.severity});Ne.begin(U,n,1e3).then(()=>setTimeout(()=>c(or,!1),120)).catch(()=>c(or,!1))}catch(v){c(or,!1),Be.error(v instanceof Error?v.message:"创建任务失败")}};function Oo(n){const v=(e(Pe)||"").split(/\r?\n/).map(U=>U.trim()).filter(Boolean),w=Array.from(new pa([...v,...n.map(U=>U.trim()).filter(Boolean)]));c(Pe,w.join(`
`),!0)}let Cs=L(!1),ns=L(""),Sa=new pa,Oa=L(ba([])),ga=L(1),ls=L(100),Za=L(0),As=j(()=>Math.max(1,Math.ceil((e(Za)||0)/(e(ls)||100)))),is=L("100");function Bo(){c(Cs,!0)}async function Ls(){try{const n=new An;(e(ns)||"").trim()&&n.set("q",e(ns).trim()),n.set("page",String(e(ga))),n.set("page_size",String(e(ls)));const v=await Nr.get(`/pocs?${n.toString()}`);if(v?.success&&v?.data){const w=v.data,U=w&&typeof w=="object"?w:null,Xe=Array.isArray(U?.items)?U.items:Array.isArray(w)?w:[];c(Oa,Xe,!0),c(Za,typeof U?.total=="number"?U.total:Xe.length,!0)}else c(Oa,[],!0),c(Za,0)}catch{c(Oa,[],!0),c(Za,0)}}async function Gs(){c(ga,1),await Ls()}async function Vs(n){const v=Math.max(1,e(As)),w=Math.max(1,Math.min(v,n));c(ga,w,!0),await Ls()}async function Fo(){await Vs(e(ga)-1)}async function Ro(){await Vs(e(ga)+1)}async function Ws(){const n=parseInt((e(is)||"").trim(),10);Number.isNaN(n)||n<=0||(c(ls,n,!0),c(is,String(n),!0),c(ga,1),await Ls())}function js(n){const v=n?.poc_id||String(n?.id||"");v&&(Sa.has(v)?Sa.delete(v):Sa.add(v))}function Do(){Sa.clear();for(const n of e(Oa)||[]){const v=n?.poc_id||String(n?.id||"");v&&Sa.add(v)}}function Ho(){Sa.clear()}let Ga=L(!1),za=L(!1),Ba=L("");function Qo(n){c(Ba,n,!0),c(Ga,!0)}async function Uo(){if(!e(Ba)){c(Ga,!1);return}if(e(za))return;const n=Ne.tasks.find(v=>v.id===e(Ba));if(n&&["running","starting","paused"].includes(n.status)){c(za,!0);try{const v=String(n.serverTaskId||n.id||""),w=await Nr.stopScan(v);if(!(!!w?.success&&!!w.data?.stopped)){Be.error(String(w?.message||"停止任务失败，无法删除")),c(za,!1);return}Ne.cancel(n.id)}catch(v){Be.error(String(v instanceof Error?v.message:"停止任务失败，无法删除")),c(za,!1);return}}try{if(Ne.removeTask(e(Ba)),e(u)&&e(u).id===e(Ba)){const v=Ne.tasks[0]?.id;v&&Ne.setActiveTask(v)}Be.success("任务已删除"),c(Ga,!1),c(Ba,"")}catch(v){Be.error(String(v instanceof Error?v.message:"删除失败"))}finally{c(za,!1)}}function qo(){let n=e(u);if(!n){const U=na(e(Pe)),Xe=Ne.createTask("POC 扫描",U);Ne.setActiveTask(Xe),n=Ne.activeTask}const v=e(Oa)||[];let w=0;for(const U of v){const Xe=U?.poc_id||String(U?.id||"");if(Xe&&Sa.has(Xe)){const _r=U?.name||Xe,ia=sr(U?.severity);Ne.addTaskPoc(n.id,{id:Xe,name:_r,severity:ia}),w++}}Be.success(`已加入 ${w} 个 PoC`)}function Go(n){let v=e(u);if(!v){const _r=na(e(Pe)),ia=Ne.createTask("POC 扫描",_r);Ne.setActiveTask(ia),v=Ne.activeTask}const w=n?.poc_id||String(n?.id||""),U=n?.name||w,Xe=sr(n?.severity);Ne.addTaskPoc(v.id,{id:w,name:U,severity:Xe}),Be.success("已加入 1 个 PoC")}function Ks(n){return sr(n?.severity)??(n?.type==="info"?"info":void 0)}function Fa(n){const v=new Date(n),w=String(v.getMonth()+1).padStart(2,"0"),U=String(v.getDate()).padStart(2,"0"),Xe=String(v.getHours()).padStart(2,"0"),_r=String(v.getMinutes()).padStart(2,"0"),ia=String(v.getSeconds()).padStart(2,"0");return`${w}-${U} ${Xe}:${_r}:${ia}`}function Vo(n){if(!n)return"0s";if(n<1e3)return`${n}ms`;const v=Math.floor(n/1e3);if(v<60)return`${v}s`;const w=Math.floor(v/60),U=v%60;return U===0?`${w}m`:`${w}m ${U}s`}const Wo=["critical","high","medium","low","info"];function va(n,v){if(!n||typeof n!="object")return 0;const w=n[v];return typeof w=="number"&&Number.isFinite(w)?w:0}function Js(n,v){if(!n||typeof n!="object")return"";const w=n[v];return typeof w=="string"?w:""}function Ko(n,v){if(!n||typeof n!="object")return!1;const w=n[v];return typeof w=="boolean"?w:!1}function ds(n,v){if(!n||typeof n!="object")return[];const w=n[v];return Array.isArray(w)?w.filter(U=>typeof U=="string"):[]}function la(n,v){if(!n||typeof n!="object")return 0;const w=n.severityStats;if(!w||typeof w!="object")return 0;const U=w[v];return typeof U=="number"&&Number.isFinite(U)?U:0}function Jo(n){if(!n||typeof n!="object")return!1;const v=n.severityStats;return!!v&&typeof v=="object"}function Yo(n){for(const v of Wo)if(la(n,v)>0)return!0;return!1}function Xo(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ys(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Zo(n){const v=(e(qt)||"").trim(),w=Ys(n||"");return v?w.split(new RegExp(`(${Xo(Ys(v))})`,"gi")).map((Xe,_r)=>_r%2===1?`<mark class="bg-yellow-400 text-black font-bold px-0.5 rounded-[2px] shadow-sm">${Xe}</mark>`:Xe).join(""):w}function Ia(n,v){const w=U=>{n.innerHTML=Zo(U||"")};return w(v),{update(U){w(U)}}}function cs(n){const v=Ks(n),w=`${Fa(n.ts)} ${n.pocName||""} ${(v||"").toUpperCase()} ${n.label||""} ${n.url||n.text||""}`.trim();navigator.clipboard.writeText(w).then(()=>Be.success("已复制日志")).catch(()=>Be.error("复制失败"))}var Xs=E(),en=d(Xs);o(en,()=>Xn,(n,v)=>{v(n,{children:(w,U)=>{var Xe=Qc(),_r=s(Xe),ia=s(_r),Ra=s(ia),Zs=s(Ra);{var tn=ot=>{var wt=Zl(),He=s(wt);let gr;var kt=r(He,2),Ot=s(kt,!0);a(kt),a(wt),P((yr,Ze)=>{gr=Rr(He,1,"size-2 shrink-0 rounded-full",null,gr,yr),ts(kt,"title",Ze),b(Ot,e(u).serverTaskId||e(u).id)},[()=>({"!bg-destructive":e(u).status==="failed","!bg-accent":e(u).status==="paused","!bg-secondary":e(u).status==="completed","!bg-primary":e(u).status==="running","!bg-muted":e(u).status==="starting"||e(u).status==="idle"}),()=>String(e(u).serverTaskId||e(u).id||"")]),t(ot,wt)},rn=ot=>{var wt=ei();p(2),t(ot,wt)};A(Zs,ot=>{e(u)?ot(tn):ot(rn,!1)})}var eo=r(Zs,2);{var an=ot=>{var wt=E(),He=d(wt);o(He,()=>Ya,(gr,kt)=>{kt(gr,{children:(Ot,yr)=>{var Ze=li(),it=d(Ze);o(it,()=>Ja,(Mr,ht)=>{ht(Mr,{children:(Wt,Xt)=>{fa(Wt,{variant:"outline",class:"h-5 cursor-pointer gap-1.5 px-1.5 font-normal transition-colors hover:bg-accent/50",children:(ft,Bt)=>{var St=ri(),et=r(d(St),2),J=s(et);a(et);var W=r(et,2);{var tt=te=>{var he=ti();t(te,he)};A(W,te=>{e(Sr)&&te(tt)})}P(()=>b(J,`+${e(Cr)??""} 后台`)),t(ft,St)},$$slots:{default:!0}})},$$slots:{default:!0}})});var Tr=r(it,2);o(Tr,()=>Ka,(Mr,ht)=>{ht(Mr,{class:"w-72 p-0",align:"start",side:"top",sideOffset:8,children:(Wt,Xt)=>{var ft=ni(),Bt=r(d(ft),2);Zt(Bt,21,()=>e(Pt),St=>St.id,(St,et)=>{var J=oi();J.__click=[ai,br,et];var W=s(J),tt=r(s(W),2),te=s(tt,!0);a(tt),a(W);var he=r(W,2),je=s(he);{var dt=nt=>{var ct=si(),Ee=s(ct,!0);a(ct),P(()=>b(Ee,e(et).severityStats?.critical)),t(nt,ct)};A(je,nt=>{(e(et).severityStats?.critical||0)>0&&nt(dt)})}var ke=r(je,2),Mt=s(ke);a(ke),a(he),a(J),P(()=>{b(te,e(et).serverTaskId||e(et).id),b(Mt,`${e(et).progress.percent??""}%`)}),t(St,J)}),a(Bt),t(Wt,ft)},$$slots:{default:!0}})}),t(Ot,Ze)},$$slots:{default:!0}})}),t(ot,wt)};A(eo,ot=>{e(Cr)>0&&ot(an)})}var sn=r(eo,2);o(sn,()=>fs,(ot,wt)=>{wt(ot,{get open(){return e(jt)},set open(He){c(jt,He,!0)},children:(He,gr)=>{var kt=E(),Ot=d(kt);o(Ot,()=>ps,(yr,Ze)=>{Ze(yr,{side:"right",class:"w-[420px]",children:(it,Tr)=>{var Mr=ui(),ht=r(s(Mr),2),Wt=s(ht);a(ht);var Xt=r(ht,2),ft=s(Xt);X(ft,{size:"sm",variant:"outline",onclick:()=>ca(),get disabled(){return e(fr)},children:(te,he)=>{p();var je=m("刷新");t(te,je)},$$slots:{default:!0}});var Bt=r(ft,2);X(Bt,{size:"sm",variant:"secondary",onclick:()=>c(jt,!1),get disabled(){return e(nr)},children:(te,he)=>{p();var je=m("取消");t(te,je)},$$slots:{default:!0}});var St=r(Bt,2);{let te=j(()=>e(nr)||!e(hr));X(St,{size:"sm",variant:"destructive",onclick:()=>Yt(),get disabled(){return e(te)},children:(he,je)=>{p();var dt=m("确认强制关闭");t(he,dt)},$$slots:{default:!0}})}a(Xt);var et=r(Xt,2),J=s(et);{var W=te=>{var he=ii();t(te,he)},tt=te=>{var he=E(),je=d(he);{var dt=Mt=>{var nt=di();t(Mt,nt)},ke=Mt=>{var nt=E(),ct=d(nt);Zt(ct,17,()=>e(pr),Ee=>Ee.instance_id,(Ee,Ft)=>{var de=vi(),me=s(de),Ie=s(me),xt=s(Ie,!0);a(Ie);var Te=r(Ie,2),Ce=s(Te,!0);a(Te);var pt=r(Te,2);{var Oe=Qe=>{var re=ci(),Se=s(re);a(re),P(()=>b(Se,`PID ${e(Ft).pid??""}`)),t(Qe,re)};A(pt,Qe=>{e(Ft).pid&&Qe(Oe)})}a(me);var $e=r(me,2),we=s($e);{let Qe=j(()=>e(hr)===e(Ft).instance_id?"default":"outline");X(we,{size:"sm",get variant(){return e(Qe)},onclick:()=>c(hr,e(Ft).instance_id,!0),children:(re,Se)=>{p();var Fe=m("选择");t(re,Fe)},$$slots:{default:!0}})}a($e),a(de),P(()=>{b(xt,e(Ft).base_url),b(Ce,e(Ft).instance_id)}),t(Ee,de)}),t(Mt,nt)};A(je,Mt=>{e(pr).length===0?Mt(dt):Mt(ke,!1)},!0)}t(te,he)};A(J,te=>{e(fr)?te(W):te(tt,!1)})}a(et),a(Mr),P(()=>b(Wt,`任务 ${e(u)?.serverTaskId??""} · 来源 ${e(u)?.serverBaseUrl??""}`)),t(it,Mr)},$$slots:{default:!0}})}),t(He,kt)},$$slots:{default:!0}})}),a(Ra);var Ms=r(Ra,2),on=s(Ms);{var nn=ot=>{var wt=$i(),He=d(wt),gr=s(He);{var kt=J=>{var W=fi(),tt=r(s(W));a(W),P(()=>b(tt,` CRIT:${e(Or)??""}`)),t(J,W)};A(gr,J=>{e(Or)>0&&J(kt)})}var Ot=r(gr,2);{var yr=J=>{var W=pi(),tt=r(s(W));a(W),P(()=>b(tt,` HIGH:${e(Zr)??""}`)),t(J,W)};A(Ot,J=>{e(Zr)>0&&J(yr)})}var Ze=r(Ot,2);{var it=J=>{var W=_i(),tt=r(s(W));a(W),P(()=>b(tt,` MED:${e(sa)??""}`)),t(J,W)};A(Ze,J=>{e(sa)>0&&J(it)})}var Tr=r(Ze,2);{var Mr=J=>{var W=gi(),tt=r(s(W));a(W),P(()=>b(tt,` LOW:${e(Br)??""}`)),t(J,W)};A(Tr,J=>{e(Br)>0&&J(Mr)})}var ht=r(Tr,2);{var Wt=J=>{var W=mi();t(J,W)};A(ht,J=>{e(Or)===0&&e(Zr)===0&&e(sa)===0&&e(Br)===0&&J(Wt)})}a(He);var Xt=r(He,2),ft=s(Xt),Bt=s(ft);a(ft);var St=r(ft,2),et=s(St);a(St),a(Xt),P(()=>{Hs(Bt,`width: ${e(u).progress.percent}%`),b(et,`${e(u).progress.percent??""}%`)}),t(ot,wt)};A(on,ot=>{e(u)&&ot(nn)})}a(Ms);var to=r(Ms,2),ln=s(to);X(ln,{variant:"ghost",size:"icon-sm","aria-label":"展开面板",onclick:Mo,children:(ot,wt)=>{var He=hi(),gr=d(He);Sn(gr,{class:"size-4"}),p(2),t(ot,He)},$$slots:{default:!0}}),a(to),a(ia),a(_r);var ro=r(_r,2);{var dn=ot=>{var wt=Od(),He=s(wt),gr=s(He);let kt;var Ot=s(gr);Ot.__pointerdown=[Xl,qa,ea];var yr=r(Ot,2),Ze=s(yr),it=s(Ze),Tr=s(it);{var Mr=de=>{var me=xi();t(de,me)};A(Tr,de=>{e(Lt)||de(Mr)})}var ht=r(Tr,2);{var Wt=de=>{var me=bi(),Ie=s(me);X(Ie,{size:"icon-sm",variant:"ghost",onclick:Vt,"aria-label":"新建任务",children:(xt,Te)=>{Ta(xt,{})},$$slots:{default:!0}}),a(me),t(de,me)},Xt=de=>{X(de,{size:"icon-sm",variant:"ghost",onclick:Vt,children:(me,Ie)=>{Ta(me,{})},$$slots:{default:!0}})};A(ht,de=>{e(Lt)?de(Wt):de(Xt,!1)})}a(it);var ft=r(it,2);{var Bt=de=>{var me=E(),Ie=d(me);o(Ie,()=>ja,(xt,Te)=>{Te(xt,{class:"flex-1 border-t",children:(Ce,pt)=>{var Oe=ki(),$e=d(Oe);o($e,()=>La,(re,Se)=>{Se(re,{class:"h-full w-full",children:(Fe,z)=>{var D=E(),ue=d(D);Zt(ue,19,()=>e(Ye),(H,_)=>`${H.id}-${_}`,(H,_)=>{var Z=wi(),g=s(Z);g.__click=[yi,br,_];var ae=s(g),se=s(ae);let Nt;var zt=r(se,2),Me=s(zt);a(zt),a(ae);var Je=r(ae,2),st=s(Je),Et=s(st);a(st),a(Je),a(g);var xe=r(g,2);xe.__click=[Pi,Qo,_];var Ue=s(xe);co(Ue,{class:"size-3.5"}),a(xe),a(Z),P(M=>{Rr(g,1,`flex w-full items-center justify-between border-t px-3 py-2 text-left first:border-t-0 ${e(u)&&e(_).id===e(u).id?"bg-muted":"hover:bg-muted/50"}`,"svelte-1k5an9e"),Nt=Rr(se,1,"size-2 shrink-0 rounded-full",null,Nt,M),b(Me,`${(e(_).serverTaskId||e(_).id)??""}${e(_).poc?` · ${e(_).poc.name}`:""}${` · 已选 ${e(_).pocs?.length||0} 个 PoC`}`),b(Et,`${e(_).progress.percent??""}%`)},[()=>({"!bg-destructive":e(_).status==="failed","!bg-accent":e(_).status==="paused","!bg-secondary":e(_).status==="completed","!bg-primary":e(_).status==="running","!bg-muted":e(_).status==="starting"||e(_).status==="idle"})]),t(H,Z)}),t(Fe,D)},$$slots:{default:!0}})});var we=r($e,2);o(we,()=>ya,(re,Se)=>{Se(re,{orientation:"vertical",children:(Fe,z)=>{var D=E(),ue=d(D);o(ue,()=>Pa,(H,_)=>{_(H,{})}),t(Fe,D)},$$slots:{default:!0}})});var Qe=r(we,2);o(Qe,()=>Qa,(re,Se)=>{Se(re,{})}),t(Ce,Oe)},$$slots:{default:!0}})}),t(de,me)},St=de=>{var me=E(),Ie=d(me);o(Ie,()=>ja,(xt,Te)=>{Te(xt,{class:"flex-1 border-t",children:(Ce,pt)=>{var Oe=Ii(),$e=d(Oe);o($e,()=>La,(re,Se)=>{Se(re,{class:"h-full w-full",children:(Fe,z)=>{var D=E(),ue=d(D);Zt(ue,19,()=>e(Ye),(H,_)=>`${H.id}-${_}`,(H,_,Z)=>{var g=zi();g.__click=[Si,br,_];var ae=s(g);let se;var Nt=r(ae,2),zt=s(Nt);a(Nt),a(g),P((Me,Je)=>{Rr(g,1,`group flex w-full items-center justify-center border-t py-2 first:border-t-0 ${e(u)&&e(_).id===e(u).id?"bg-muted":"hover:bg-muted/50"}`,"svelte-1k5an9e"),ts(g,"aria-label",Me),ts(g,"title",`${e(_).serverTaskId||e(_).id} · ${e(_).progress.percent}%`),se=Rr(ae,1,"block h-1.5 w-1.5 rounded-full",null,se,Je),b(zt,`${e(_).progress.percent??""}%`)},[()=>`切换任务 ${String(e(Z)+1)}`,()=>({"!bg-destructive":e(_).status==="failed","!bg-accent":e(_).status==="paused","!bg-secondary":e(_).status==="completed","!bg-primary":e(_).status==="running","!bg-muted":e(_).status==="starting"||e(_).status==="idle"})]),t(H,g)}),t(Fe,D)},$$slots:{default:!0}})});var we=r($e,2);o(we,()=>ya,(re,Se)=>{Se(re,{orientation:"vertical",children:(Fe,z)=>{var D=E(),ue=d(D);o(ue,()=>Pa,(H,_)=>{_(H,{})}),t(Fe,D)},$$slots:{default:!0}})});var Qe=r(we,2);o(Qe,()=>Qa,(re,Se)=>{Se(re,{})}),t(Ce,Oe)},$$slots:{default:!0}})}),t(de,me)};A(ft,de=>{e(Lt)?de(St,!1):de(Bt)})}a(Ze);var et=r(Ze,2),J=s(et),W=s(J),tt=s(W);X(tt,{size:"icon-sm",variant:"ghost","aria-label":"日志与侧栏",onclick:Vr,children:(de,me)=>{io(de,{})},$$slots:{default:!0}});var te=r(tt,2);o(te,()=>_s,(de,me)=>{me(de,{type:"single",get value(){return e(at)},onValueChange:Ie=>{c(at,Ie,!0)},children:(Ie,xt)=>{var Te=Ai(),Ce=d(Te);o(Ce,()=>gs,(Oe,$e)=>{$e(Oe,{size:"sm","aria-label":"严重级",children:(we,Qe)=>{var re=Ti(),Se=s(re,!0);a(re),P(Fe=>b(Se,Fe),[()=>e(at)==="all"?"ALL":e(at).toUpperCase()]),t(we,re)},$$slots:{default:!0}})});var pt=r(Ce,2);o(pt,()=>ms,(Oe,$e)=>{$e(Oe,{class:"min-w-40",children:(we,Qe)=>{var re=Ci(),Se=d(re);o(Se,()=>Qr,(_,Z)=>{Z(_,{value:"all",children:(g,ae)=>{p();var se=m("ALL");t(g,se)},$$slots:{default:!0}})});var Fe=r(Se,2);o(Fe,()=>Qr,(_,Z)=>{Z(_,{value:"critical",children:(g,ae)=>{p();var se=m("CRITICAL");t(g,se)},$$slots:{default:!0}})});var z=r(Fe,2);o(z,()=>Qr,(_,Z)=>{Z(_,{value:"high",children:(g,ae)=>{p();var se=m("HIGH");t(g,se)},$$slots:{default:!0}})});var D=r(z,2);o(D,()=>Qr,(_,Z)=>{Z(_,{value:"medium",children:(g,ae)=>{p();var se=m("MEDIUM");t(g,se)},$$slots:{default:!0}})});var ue=r(D,2);o(ue,()=>Qr,(_,Z)=>{Z(_,{value:"low",children:(g,ae)=>{p();var se=m("LOW");t(g,se)},$$slots:{default:!0}})});var H=r(ue,2);o(H,()=>Qr,(_,Z)=>{Z(_,{value:"info",children:(g,ae)=>{p();var se=m("INFO");t(g,se)},$$slots:{default:!0}})}),t(we,re)},$$slots:{default:!0}})}),t(Ie,Te)},$$slots:{default:!0}})});var he=r(te,2);da(he,{class:"h-8 w-48",placeholder:"搜索日志",get value(){return e(qt)},set value(de){c(qt,de,!0)}}),a(W);var je=r(W,2),dt=r(s(je),2);rs(dt,{get checked(){return e(qr)},set checked(de){c(qr,de,!0)}});var ke=r(dt,2),Mt=s(ke);o(Mt,()=>$a,(de,me)=>{me(de,{children:(Ie,xt)=>{var Te=Li(),Ce=d(Te);o(Ce,()=>ha,(Oe,$e)=>{$e(Oe,{children:(we,Qe)=>{{let re=j(()=>e($)>=.9?"还原":"最大化");X(we,{variant:"ghost",size:"icon-sm",class:"h-7 w-7 text-muted-foreground hover:text-foreground",get"aria-label"(){return e(re)},onclick:()=>Ne.setPanelSnap(e($)>=.9?.33:1),children:(Se,Fe)=>{var z=E(),D=d(z);{var ue=_=>{In(_,{class:"size-4"})},H=_=>{Tn(_,{class:"size-3.5"})};A(D,_=>{e($)>=.9?_(ue):_(H,!1)})}t(Se,z)},$$slots:{default:!0}})}},$$slots:{default:!0}})});var pt=r(Ce,2);o(pt,()=>xa,(Oe,$e)=>{$e(Oe,{children:(we,Qe)=>{p();var re=m();P(()=>b(re,e($)>=.9?"还原":"最大化")),t(we,re)},$$slots:{default:!0}})}),t(Ie,Te)},$$slots:{default:!0}})});var nt=r(Mt,2);o(nt,()=>$a,(de,me)=>{me(de,{children:(Ie,xt)=>{var Te=ji(),Ce=d(Te);o(Ce,()=>ha,(Oe,$e)=>{$e(Oe,{children:(we,Qe)=>{X(we,{variant:"ghost",size:"icon-sm",class:"h-7 w-7 text-muted-foreground hover:text-foreground","aria-label":"最小化",onclick:Na,children:(re,Se)=>{Ha(re,{class:"size-4"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var pt=r(Ce,2);o(pt,()=>xa,(Oe,$e)=>{$e(Oe,{children:(we,Qe)=>{p();var re=m("最小化");t(we,re)},$$slots:{default:!0}})}),t(Ie,Te)},$$slots:{default:!0}})}),a(ke),a(je),a(J);var ct=r(J,2);o(ct,()=>ja,(de,me)=>{me(de,{class:"flex-1 overflow-hidden",children:(Ie,xt)=>{var Te=cd(),Ce=d(Te);o(Ce,()=>La,($e,we)=>{we($e,{class:"h-full w-full px-4 py-4",get ref(){return e(jr)},set ref(Qe){c(jr,Qe,!0)},children:(Qe,re)=>{var Se=dd(),Fe=s(Se);{var z=ue=>{var H=Mi(),_=s(H);io(_,{class:"mb-2 size-10 opacity-20"}),p(2),a(H),t(ue,H)},D=ue=>{var H=E(),_=d(H);Zt(_,19,()=>e(Ma),(Z,g)=>`${Z.ts}-${g}`,(Z,g)=>{var ae=E(),se=d(ae);{var Nt=Me=>{var Je=sd(),st=s(Je);{var Et=R=>{var B=Wi(),Ae=d(B),F=s(Ae),ce=s(F);uo(ce,{class:"size-4"}),p(2),a(F);var _e=r(F,2),S=r(s(_e),2),Q=s(S,!0);a(S);var G=r(S,4),I=s(G,!0);a(G);var k=r(G,4),ge=s(k,!0);a(k);var fe=r(k,2);{var V=N=>{var ve=Ni(),ee=r(d(ve),2),be=s(ee,!0);a(ee),P((ne,gt)=>{Rr(ee,1,ne,"svelte-1k5an9e"),b(be,gt)},[()=>`text-right font-mono font-bold ${e(u)?.scanInfo?.oob_enabled??Ko(e(g).data,"oob_enabled")?"text-green-300":"text-yellow-300"}`,()=>e(u)?.scanInfo?.oob_status??Js(e(g).data,"oob_status")]),t(N,ve)};A(fe,N=>{(e(u)?.scanInfo?.oob_status||Js(e(g).data,"oob_status"))&&N(V)})}a(_e);var Y=r(_e,2);{var Re=N=>{var ve=Oi(),ee=r(s(ve),2);Zt(ee,20,()=>Lr,be=>be,(be,ne)=>{var gt=E(),rt=d(gt);{var ye=le=>{var Ge=Ei(),Ke=s(Ge),Le=s(Ke,!0);a(Ke);var It=r(Ke,2),mr=s(It),Yr=r(mr);{var Xr=Fr=>{var aa=m();P(()=>b(aa,` ${e(u).phaseProgress[ne].percent}%`)),t(Fr,aa)};A(Yr,Fr=>{e(u).phaseProgress[ne].percent!==void 0&&Fr(Xr)})}a(It),a(Ge),P(()=>{b(Le,kr[ne]),b(mr,`${e(u).phaseProgress[ne].status??""} `)}),t(le,Ge)};A(rt,le=>{e(u)?.phaseProgress?.[ne]&&le(ye)})}t(be,gt)}),a(ee),a(ve),t(N,ve)};A(Y,N=>{e(u)?.phaseProgress&&N(Re)})}var K=r(Y,2);{var oe=N=>{var ve=Ri(),ee=s(ve),be=r(s(ee),2),ne=s(be);{var gt=Le=>{var It=m("显示前 5 条");t(Le,It)},rt=Le=>{var It=m();P(mr=>b(It,`共 ${mr??""} 条`),[()=>e(u)?.scanInfo?.total_targets??va(e(g).data,"total_targets")]),t(Le,It)};A(ne,Le=>{(e(u)?.scanInfo?.total_targets??va(e(g).data,"total_targets"))>5?Le(gt):Le(rt,!1)})}a(be),a(ee);var ye=r(ee,2),le=s(ye);Zt(le,19,()=>(e(u)?.scanInfo?.targets||ds(e(g).data,"targets")).slice(0,5),(Le,It)=>`${Le}-${It}`,(Le,It,mr,Yr)=>{var Xr=Bi(),Fr=r(s(Xr),2);Ca(Fr,(aa,ua)=>Ia?.(aa,ua),()=>e(It)),a(Xr),t(Le,Xr)});var Ge=r(le,2);{var Ke=Le=>{var It=Fi(),mr=s(It);a(It),P(Yr=>b(mr,`... 还有 ${Yr??""} 个目标`),[()=>(e(u)?.scanInfo?.total_targets??va(e(g).data,"total_targets"))-(e(u)?.scanInfo?.targets||ds(e(g).data,"targets")).slice(0,5).length]),t(Le,It)};A(Ge,Le=>{(e(u)?.scanInfo?.total_targets??va(e(g).data,"total_targets"))>(e(u)?.scanInfo?.targets||ds(e(g).data,"targets")).slice(0,5).length&&Le(Ke)})}a(ye),a(ve),t(N,ve)};A(K,N=>{(e(u)?.scanInfo?.targets||ds(e(g).data,"targets")).length>0&&N(oe)})}a(Ae);var O=r(Ae,2);{var _t=N=>{var ve=Qi(),ee=s(ve),be=s(ee),ne=s(be);fa(ne,{variant:"secondary",class:"h-5 rounded-sm px-1.5 text-[10px] font-bold",children:(Le,It)=>{p();var mr=m("HOST");t(Le,mr)},$$slots:{default:!0}});var gt=r(ne,4),rt=s(gt);a(gt),a(be);var ye=r(be,2);{var le=Le=>{var It=Di(),mr=s(It);a(It),P(()=>b(mr,`${e(u).phaseProgress.host_discovery.percent??0??""}% (${e(u).phaseProgress.host_discovery.finished??0??""}/${e(u).phaseProgress.host_discovery.total??0??""})`)),t(Le,It)};A(ye,Le=>{e(u)?.phaseProgress?.host_discovery&&Le(le)})}a(ee);var Ge=r(ee,2),Ke=s(Ge);Zt(Ke,23,()=>[...e(Dt)].slice(-200).reverse(),(Le,It)=>`host-${Le.ts}-${It}`,(Le,It,mr,Yr)=>{var Xr=Hi(),Fr=s(Xr),aa=s(Fr);Ca(aa,(es,lo)=>Ia?.(es,lo),()=>e(It).text),a(Fr);var ua=r(Fr,2),Va=s(ua);X(Va,{variant:"ghost",size:"icon-sm",class:"h-6 w-6 shrink-0",onclick:()=>cs(e(It)),children:(es,lo)=>{vs(es,{class:"size-3"})},$$slots:{default:!0}});var Hr=r(Va,2),Da=s(Hr,!0);a(Hr),a(ua),a(Xr),P(es=>b(Da,es),[()=>Fa(e(It).ts)]),t(Le,Xr)}),a(Ke),a(Ge),a(ve),P(()=>b(rt,`(${e(Dt).length??""})`)),t(N,ve)};A(O,N=>{e(Dt).length>0&&N(_t)})}var De=r(O,2);{var qe=N=>{var ve=qi(),ee=s(ve),be=s(ee),ne=s(be);fa(ne,{variant:"secondary",class:"h-5 rounded-sm px-1.5 text-[10px] font-bold",children:(Ge,Ke)=>{p();var Le=m("PORT");t(Ge,Le)},$$slots:{default:!0}});var gt=r(ne,4),rt=s(gt);a(gt),a(be),a(ee);var ye=r(ee,2),le=s(ye);Zt(le,23,()=>[...e(rr)].slice(-200).reverse(),(Ge,Ke)=>`port-${Ge.ts}-${Ke}`,(Ge,Ke,Le,It)=>{var mr=Ui(),Yr=s(mr),Xr=s(Yr);Ca(Xr,(Hr,Da)=>Ia?.(Hr,Da),()=>e(Ke).text),a(Yr);var Fr=r(Yr,2),aa=s(Fr);X(aa,{variant:"ghost",size:"icon-sm",class:"h-6 w-6 shrink-0",onclick:()=>cs(e(Ke)),children:(Hr,Da)=>{vs(Hr,{class:"size-3"})},$$slots:{default:!0}});var ua=r(aa,2),Va=s(ua,!0);a(ua),a(Fr),a(mr),P(Hr=>b(Va,Hr),[()=>Fa(e(Ke).ts)]),t(Ge,mr)}),a(le),a(ye),a(ve),P(()=>b(rt,`(${e(rr).length??""})`)),t(N,ve)};A(De,N=>{e(rr).length>0&&N(qe)})}var Rt=r(De,2);{var We=N=>{var ve=Vi(),ee=s(ve),be=s(ee),ne=s(be);fa(ne,{variant:"secondary",class:"h-5 rounded-sm px-1.5 text-[10px] font-bold",children:(Ge,Ke)=>{p();var Le=m("WEB");t(Ge,Le)},$$slots:{default:!0}});var gt=r(ne,4),rt=s(gt);a(gt),a(be),a(ee);var ye=r(ee,2),le=s(ye);Zt(le,23,()=>[...e($t)].slice(-200).reverse(),(Ge,Ke)=>`web-${Ge.ts}-${Ke}`,(Ge,Ke,Le,It)=>{var mr=Gi(),Yr=s(mr),Xr=s(Yr);Ca(Xr,(Hr,Da)=>Ia?.(Hr,Da),()=>e(Ke).text),a(Yr);var Fr=r(Yr,2),aa=s(Fr);X(aa,{variant:"ghost",size:"icon-sm",class:"h-6 w-6 shrink-0",onclick:()=>cs(e(Ke)),children:(Hr,Da)=>{vs(Hr,{class:"size-3"})},$$slots:{default:!0}});var ua=r(aa,2),Va=s(ua,!0);a(ua),a(Fr),a(mr),P(Hr=>b(Va,Hr),[()=>Fa(e(Ke).ts)]),t(Ge,mr)}),a(le),a(ye),a(ve),P(()=>b(rt,`(${e($t).length??""})`)),t(N,ve)};A(Rt,N=>{e($t).length>0&&N(We)})}P((N,ve,ee)=>{b(Q,N),b(I,ve),b(ge,ee)},[()=>e(u)?.scanInfo?.total_targets??va(e(g).data,"total_targets"),()=>e(u)?.scanInfo?.total_pocs??va(e(g).data,"total_pocs"),()=>e(u)?.scanInfo?.total_scans??va(e(g).data,"total_scans")]),t(R,B)},xe=R=>{var B=E(),Ae=d(B);{var F=_e=>{var S=rd(),Q=s(S),G=s(Q);jn(G,{class:"size-4"}),p(2),a(Q);var I=r(Q,2),k=r(s(I),2),ge=s(k,!0);a(k);var fe=r(k,4),V=s(fe);a(fe),a(I);var Y=r(I,2);{var Re=K=>{var oe=td(),O=r(s(oe),2),_t=s(O);{var De=ye=>{var le=Ki(),Ge=r(s(le),2),Ke=s(Ge,!0);a(Ge),a(le),P(Le=>b(Ke,Le),[()=>la(e(g).data,"critical")]),t(ye,le)};A(_t,ye=>{la(e(g).data,"critical")>0&&ye(De)})}var qe=r(_t,2);{var Rt=ye=>{var le=Ji(),Ge=r(s(le),2),Ke=s(Ge,!0);a(Ge),a(le),P(Le=>b(Ke,Le),[()=>la(e(g).data,"high")]),t(ye,le)};A(qe,ye=>{la(e(g).data,"high")>0&&ye(Rt)})}var We=r(qe,2);{var N=ye=>{var le=Yi(),Ge=r(s(le),2),Ke=s(Ge,!0);a(Ge),a(le),P(Le=>b(Ke,Le),[()=>la(e(g).data,"medium")]),t(ye,le)};A(We,ye=>{la(e(g).data,"medium")>0&&ye(N)})}var ve=r(We,2);{var ee=ye=>{var le=Xi(),Ge=r(s(le),2),Ke=s(Ge,!0);a(Ge),a(le),P(Le=>b(Ke,Le),[()=>la(e(g).data,"low")]),t(ye,le)};A(ve,ye=>{la(e(g).data,"low")>0&&ye(ee)})}var be=r(ve,2);{var ne=ye=>{var le=Zi(),Ge=r(s(le),2),Ke=s(Ge,!0);a(Ge),a(le),P(Le=>b(Ke,Le),[()=>la(e(g).data,"info")]),t(ye,le)};A(be,ye=>{la(e(g).data,"info")>0&&ye(ne)})}a(O);var gt=r(O,2);{var rt=ye=>{var le=ed();t(ye,le)};A(gt,ye=>{Yo(e(g).data)||ye(rt)})}a(oe),t(K,oe)};A(Y,K=>{Jo(e(g).data)&&K(Re)})}a(S),P((K,oe,O)=>{b(ge,K),b(V,`${oe??""} / ${O??""}`)},[()=>Vo(va(e(g).data,"duration")),()=>va(e(g).data,"finished"),()=>va(e(g).data,"total")]),t(_e,S)},ce=_e=>{var S=ad(),Q=s(S);Ca(Q,(G,I)=>Ia?.(G,I),()=>e(g).text),a(S),t(_e,S)};A(Ae,_e=>{e(g).text==="Scan Completed"?_e(F):_e(ce,!1)},!0)}t(R,B)};A(st,R=>{e(g).text==="Scan Started"?R(Et):R(xe,!1)})}var Ue=r(st,2),M=s(Ue,!0);a(Ue),a(Je),P(R=>b(M,R),[()=>Fa(e(g).ts)]),t(Me,Je)},zt=Me=>{var Je=E(),st=d(Je);{var Et=Ue=>{var M=nd(),R=s(M),B=s(R),Ae=s(B);Ln(Ae,{class:"size-5"}),a(B);var F=r(B,2),ce=s(F),_e=s(ce),S=s(_e),Q=s(S);{let O=j(()=>`h-5 rounded-sm px-1.5 text-[10px] font-bold tracking-wider uppercase ${el(e(g).severity||"")}`);fa(Q,{variant:"secondary",get class(){return e(O)},children:(_t,De)=>{p();var qe=m();P(()=>b(qe,e(g).severity)),t(_t,qe)},$$slots:{default:!0}})}var G=r(Q,2),I=s(G);Ca(I,(O,_t)=>Ia?.(O,_t),()=>e(g).pocName||""),a(G),a(S);var k=r(S,2);X(k,{variant:"ghost",size:"icon-sm",class:"h-6 w-6 shrink-0",onclick:()=>cs(e(g)),children:(O,_t)=>{vs(O,{class:"size-3"})},$$slots:{default:!0}}),a(_e);var ge=r(_e,2),fe=s(ge);Ca(fe,(O,_t)=>Ia?.(O,_t),()=>e(g).url||e(g).text||""),a(ge),a(ce);var V=r(ce,2),Y=s(V);{var Re=O=>{var _t=od(),De=s(_t);a(_t),P(()=>b(De,`#${e(g).seq??""}`)),t(O,_t)};A(Y,O=>{e(g).seq&&O(Re)})}var K=r(Y,2),oe=s(K,!0);a(K),a(V),a(F),a(R),a(M),P(O=>{ts(G,"title",e(g).pocName||""),b(oe,O)},[()=>Fa(e(g).ts)]),t(Ue,M)},xe=Ue=>{var M=id(),R=s(M),B=s(R);{var Ae=S=>{var Q=ld();t(S,Q)};A(B,S=>{e(g).type==="error"&&S(Ae)})}var F=r(B,2);Ca(F,(S,Q)=>Ia?.(S,Q),()=>e(g).text),a(R);var ce=r(R,2),_e=s(ce,!0);a(ce),a(M),P(S=>{Rr(R,1,`rounded-2xl rounded-tl-sm px-4 py-2.5 text-sm leading-relaxed shadow-sm ${e(g).type==="error"?"border border-destructive/20 bg-destructive/10 text-destructive":"bg-muted text-foreground/90"}`,"svelte-1k5an9e"),b(_e,S)},[()=>Fa(e(g).ts)]),t(Ue,M)};A(st,Ue=>{e(g).type==="hit"?Ue(Et):Ue(xe,!1)},!0)}t(Me,Je)};A(se,Me=>{Gr(e(g))?Me(Nt):Me(zt,!1)})}t(Z,ae)}),t(ue,H)};A(Fe,ue=>{e(Ma).length===0?ue(z):ue(D,!1)})}a(Se),t(Qe,Se)},$$slots:{default:!0}})});var pt=r(Ce,2);o(pt,()=>ya,($e,we)=>{we($e,{orientation:"vertical",children:(Qe,re)=>{var Se=E(),Fe=d(Se);o(Fe,()=>Pa,(z,D)=>{D(z,{})}),t(Qe,Se)},$$slots:{default:!0}})});var Oe=r(pt,2);o(Oe,()=>Qa,($e,we)=>{we($e,{})}),t(Ie,Te)},$$slots:{default:!0}})});var Ee=r(ct,2),Ft=s(Ee);o(Ft,()=>Ya,(de,me)=>{me(de,{get open(){return e(Ht)},set open(Ie){c(Ht,Ie,!0)},children:(Ie,xt)=>{var Te=Ed(),Ce=d(Te);o(Ce,()=>Ja,(Oe,$e)=>{$e(Oe,{children:(we,Qe)=>{var re=E(),Se=d(re);o(Se,()=>Aa,(Fe,z)=>{z(Fe,{class:"flex-1",children:(D,ue)=>{var H=kd(),_=d(H);o(_,()=>ma,(g,ae)=>{ae(g,{align:"block-start",class:"py-1",children:(se,Nt)=>{var zt=ud(),Me=d(zt),Je=s(Me,!0);a(Me);var st=r(Me,2);{var Et=xe=>{var Ue=vd(),M=s(Ue);a(Ue),P(()=>b(M,`…（共 ${e(bt).length??""} 条）`)),t(xe,Ue)};A(st,xe=>{e(bt).length>1&&xe(Et)})}P(()=>{Rr(Me,1,`truncate text-sm leading-4 ${e(lt)?"text-foreground":"text-muted-foreground"}`,"svelte-1k5an9e"),b(Je,e(lt)||"输入资产或从地址库选择...")}),t(se,zt)},$$slots:{default:!0}})});var Z=r(_,2);o(Z,()=>ma,(g,ae)=>{ae(g,{align:"inline-end",onclick:se=>{se.stopPropagation()},children:(se,Nt)=>{var zt=wd(),Me=d(zt);o(Me,()=>tr,(M,R)=>{R(M,{variant:"ghost","aria-label":"打开 PoC 选择器",onpointerdown:B=>B.stopPropagation(),onmousedown:B=>B.stopPropagation(),onclick:B=>{B.stopPropagation(),Bo()},children:(B,Ae)=>{p();var F=m();P(()=>b(F,(e(u)?.pocs?.length||0)>0?`已选${e(u)?.pocs?.length}个`:"全部 PoCs")),t(B,F)},$$slots:{default:!0}})});var Je=r(Me,2);o(Je,()=>tr,(M,R)=>{R(M,{variant:"ghost","aria-label":"打开扫描策略",onpointerdown:B=>B.stopPropagation(),onmousedown:B=>B.stopPropagation(),onclick:B=>{B.stopPropagation(),c(Dr,!0)},children:(B,Ae)=>{p();var F=m();P(ce=>b(F,ce),[()=>Tt.getActive()?.name||"选择策略"]),t(B,F)},$$slots:{default:!0}})});var st=r(Je,2);{var Et=M=>{var R=E(),B=d(R);o(B,()=>$a,(Ae,F)=>{F(Ae,{children:(ce,_e)=>{var S=fd(),Q=d(S);{const I=(k,ge)=>{let fe=()=>ge?.().props;var V=E(),Y=d(V);{let Re=j(()=>e(or)||e(bt).length===0);o(Y,()=>tr,(K,oe)=>{oe(K,Pr(fe,{variant:"outline",class:"cursor-pointer rounded-md",size:"icon-sm",get disabled(){return e(Re)},"aria-label":"开始",onpointerdown:O=>O.stopPropagation(),onmousedown:O=>O.stopPropagation(),onclick:O=>{O.stopPropagation(),Eo()},children:(O,_t)=>{Mn(O,{})},$$slots:{default:!0}}))})}t(k,V)};o(Q,()=>ha,(k,ge)=>{ge(k,{child:I,$$slots:{child:!0}})})}var G=r(Q,2);o(G,()=>xa,(I,k)=>{k(I,{side:"top",align:"center",children:(ge,fe)=>{p();var V=m("开始");t(ge,V)},$$slots:{default:!0}})}),t(ce,S)},$$slots:{default:!0}})}),t(M,R)};A(st,M=>{(!e(u)||["idle","completed","failed","cancelled"].includes(e(u).status))&&M(Et)})}var xe=r(st,2);{var Ue=M=>{var R=Pd(),B=d(R);{var Ae=S=>{var Q=E(),G=d(Q);o(G,()=>Ya,(I,k)=>{k(I,{children:(ge,fe)=>{var V=gd(),Y=d(V);{const K=(oe,O)=>{let _t=()=>O?.().props;var De=E(),qe=d(De);o(qe,()=>tr,(Rt,We)=>{We(Rt,Pr(_t,{variant:"outline",class:"rounded-md",size:"icon-sm","aria-label":"暂停",get disabled(){return e($r)},onpointerdown:N=>N.stopPropagation(),onmousedown:N=>N.stopPropagation(),children:(N,ve)=>{Nn(N,{})},$$slots:{default:!0}}))}),t(oe,De)};o(Y,()=>Ja,(oe,O)=>{O(oe,{child:K,$$slots:{child:!0}})})}var Re=r(Y,2);o(Re,()=>Ka,(K,oe)=>{oe(K,{align:"center",sideOffset:6,class:"w-64 p-3",children:(O,_t)=>{var De=_d(),qe=r(s(De),2);{var Rt=ee=>{var be=pd(),ne=d(be),gt=s(ne,!0);a(ne);var rt=r(ne,2),ye=s(rt);X(ye,{size:"sm",variant:"destructive",get disabled(){return e(nr)},onclick:le=>{le.stopPropagation(),ta()},children:(le,Ge)=>{p();var Ke=m("强制关闭");t(le,Ke)},$$slots:{default:!0}}),a(rt),P(()=>b(gt,e(Jt))),t(ee,be)};A(qe,ee=>{e(Jt)&&ee(Rt)})}var We=r(qe,2),N=s(We);{const ee=(be,ne)=>{let gt=()=>ne?.().props;X(be,Pr(gt,{size:"sm",variant:"destructive",get disabled(){return e($r)},onclick:rt=>{gt()?.onclick?.(rt),xr()},children:(rt,ye)=>{p();var le=m("确认暂停");t(rt,le)},$$slots:{default:!0}}))};o(N,()=>$s,(be,ne)=>{ne(be,{child:ee,$$slots:{child:!0}})})}var ve=r(N,2);{const ee=(be,ne)=>{X(be,Pr(()=>ne?.().props,{size:"sm",variant:"secondary",children:(rt,ye)=>{p();var le=m("取消");t(rt,le)},$$slots:{default:!0}}))};o(ve,()=>$s,(be,ne)=>{ne(be,{child:ee,$$slots:{child:!0}})})}a(We),a(De),t(O,De)},$$slots:{default:!0}})}),t(ge,V)},$$slots:{default:!0}})}),t(S,Q)},F=S=>{var Q=E(),G=d(Q);{var I=k=>{var ge=E(),fe=d(ge);o(fe,()=>$a,(V,Y)=>{Y(V,{children:(Re,K)=>{var oe=$d(),O=d(oe);{const De=(qe,Rt)=>{let We=()=>Rt?.().props;var N=E(),ve=d(N);o(ve,()=>tr,(ee,be)=>{be(ee,Pr(We,{variant:"outline",class:"rounded-md",size:"icon-sm","aria-label":"继续",get disabled(){return e(zr)},onpointerdown:ne=>ne.stopPropagation(),onmousedown:ne=>ne.stopPropagation(),onclick:ne=>{ne.stopPropagation(),Wr(),Be.success("已继续")},children:(ne,gt)=>{var rt=md(),ye=d(rt);uo(ye,{}),p(2),t(ne,rt)},$$slots:{default:!0}}))}),t(qe,N)};o(O,()=>ha,(qe,Rt)=>{Rt(qe,{child:De,$$slots:{child:!0}})})}var _t=r(O,2);o(_t,()=>xa,(De,qe)=>{qe(De,{side:"top",align:"center",children:(Rt,We)=>{p();var N=m("继续");t(Rt,N)},$$slots:{default:!0}})}),t(Re,oe)},$$slots:{default:!0}})}),t(k,ge)};A(G,k=>{e(u).status==="paused"&&k(I)},!0)}t(S,Q)};A(B,S=>{e(u).status==="running"||e(u).status==="starting"?S(Ae):S(F,!1)})}var ce=r(B,2);{var _e=S=>{var Q=E(),G=d(Q);o(G,()=>Ya,(I,k)=>{k(I,{children:(ge,fe)=>{var V=yd(),Y=d(V);{const K=(oe,O)=>{let _t=()=>O?.().props;var De=E(),qe=d(De);o(qe,()=>tr,(Rt,We)=>{We(Rt,Pr(_t,{variant:"destructive",class:"rounded-md",size:"icon-sm","aria-label":"停止",get disabled(){return e(Qt)},onpointerdown:N=>N.stopPropagation(),onmousedown:N=>N.stopPropagation(),children:(N,ve)=>{var ee=hd(),be=d(ee);vo(be,{}),p(2),t(N,ee)},$$slots:{default:!0}}))}),t(oe,De)};o(Y,()=>Ja,(oe,O)=>{O(oe,{child:K,$$slots:{child:!0}})})}var Re=r(Y,2);o(Re,()=>Ka,(K,oe)=>{oe(K,{align:"center",sideOffset:6,class:"w-64 p-3",children:(O,_t)=>{var De=bd(),qe=r(s(De),2);{var Rt=ee=>{var be=xd(),ne=d(be),gt=s(ne,!0);a(ne);var rt=r(ne,2),ye=s(rt);X(ye,{size:"sm",variant:"destructive",get disabled(){return e(nr)},onclick:le=>{le.stopPropagation(),ta()},children:(le,Ge)=>{p();var Ke=m("强制关闭");t(le,Ke)},$$slots:{default:!0}}),a(rt),P(()=>b(gt,e(Gt))),t(ee,be)};A(qe,ee=>{e(Gt)&&ee(Rt)})}var We=r(qe,2),N=s(We);{const ee=(be,ne)=>{let gt=()=>ne?.().props;X(be,Pr(gt,{size:"sm",variant:"destructive",get disabled(){return e(Qt)},onclick:rt=>{gt()?.onclick?.(rt),oa()},children:(rt,ye)=>{p();var le=m("确认停止");t(rt,le)},$$slots:{default:!0}}))};o(N,()=>$s,(be,ne)=>{ne(be,{child:ee,$$slots:{child:!0}})})}var ve=r(N,2);{const ee=(be,ne)=>{X(be,Pr(()=>ne?.().props,{size:"sm",variant:"secondary",onclick:rt=>{rt.stopPropagation()},children:(rt,ye)=>{p();var le=m("取消");t(rt,le)},$$slots:{default:!0}}))};o(ve,()=>$s,(be,ne)=>{ne(be,{child:ee,$$slots:{child:!0}})})}a(We),a(De),t(O,De)},$$slots:{default:!0}})}),t(ge,V)},$$slots:{default:!0}})}),t(S,Q)};A(ce,S=>{(e(u).status==="running"||e(u).status==="paused"||e(u).status==="starting")&&S(_e)})}t(M,R)};A(xe,M=>{e(u)&&M(Ue)})}t(se,zt)},$$slots:{default:!0}})}),t(D,H)},$$slots:{default:!0}})}),t(we,re)},$$slots:{default:!0}})});var pt=r(Ce,2);o(pt,()=>Ka,(Oe,$e)=>{$e(Oe,{side:"top",align:"start",class:" w-[min(720px,90vw)] p-3",preventScroll:!0,trapFocus:!1,onOpenAutoFocus:async we=>{we.preventDefault(),await Ns(),e(Ut)?.focus()},onCloseAutoFocus:we=>{we.preventDefault()},children:(we,Qe)=>{var re=E(),Se=d(re);o(Se,()=>Aa,(Fe,z)=>{z(Fe,{class:"max-h-[45vh] overflow-auto",style:"scrollbar-gutter: stable; overscroll-behavior: contain; -webkit-overflow-scrolling: touch",children:(D,ue)=>{var H=Nd(),_=d(H);o(_,()=>ma,(g,ae)=>{ae(g,{align:"block-start",class:"sticky top-0 z-10 border-b bg-popover",children:(se,Nt)=>{var zt=Md(),Me=d(zt);o(Me,()=>Ya,(M,R)=>{R(M,{get open(){return e(pe)},set open(B){c(pe,B,!0)},children:(B,Ae)=>{var F=Td(),ce=d(F),_e=s(ce);da(_e,{class:"h-8 w-64",placeholder:"搜索地址库文件名",onfocus:()=>{c(vt,!0),c(ze,0)},onblur:()=>{setTimeout(()=>c(vt,!1),120)},onkeydown:G=>{const I=G.key;e(ut).length&&(I==="ArrowDown"?(c(ze,(e(ze)+1)%e(ut).length),G.preventDefault()):I==="ArrowUp"?(c(ze,(e(ze)-1+e(ut).length)%e(ut).length),G.preventDefault()):I==="Enter"?(Ct(e(ut)[e(ze)]),G.preventDefault()):I==="Escape"&&c(pe,!1))},get value(){return e(Ve)},set value(G){c(Ve,G,!0)},get ref(){return e(cr)},set ref(G){c(cr,G,!0)}});var S=r(_e,2);o(S,()=>Ja,(G,I)=>{I(G,{class:"pointer-events-none absolute top-full left-0 h-[1px] w-full opacity-0","aria-hidden":"true"})}),a(ce);var Q=r(ce,2);o(Q,()=>Ka,(G,I)=>{I(G,{side:"bottom",align:"start",sideOffset:6,trapFocus:!1,onOpenAutoFocus:k=>k.preventDefault(),onCloseAutoFocus:k=>k.preventDefault(),interactOutsideBehavior:"ignore",escapeKeydownBehavior:"ignore",class:"z-50 max-h-[40vh] min-w-[16rem] overflow-auto rounded-md border bg-popover p-1 text-popover-foreground shadow-md outline-hidden",get ref(){return e(ar)},set ref(k){c(ar,k,!0)},children:(k,ge)=>{var fe=E(),V=d(fe);Zt(V,19,()=>e(ut),Y=>Y.id,(Y,Re,K)=>{var oe=Id();oe.__pointerdown=[Sd],oe.__click=[zd,Ct,Re];var O=s(oe),_t=s(O,!0);a(O);var De=r(O,2);fa(De,{variant:"outline",class:"h-5",children:(qe,Rt)=>{p();var We=m();P(()=>b(We,e(Re).line_count??0)),t(qe,We)},$$slots:{default:!0}}),a(oe),P(()=>{ts(oe,"data-asset-set-index",e(K)),Rr(oe,1,`flex w-full items-center justify-between rounded px-2 py-1 text-sm ${e(ze)===e(K)?"bg-muted":"hover:bg-muted/50"}`,"svelte-1k5an9e"),b(_t,e(Re).name||e(Re).id)}),t(Y,oe)}),t(k,fe)},$$slots:{default:!0}})}),t(B,F)},$$slots:{default:!0}})});var Je=r(Me,2);o(Je,()=>$a,(M,R)=>{R(M,{children:(B,Ae)=>{var F=Cd(),ce=d(F);o(ce,()=>ha,(S,Q)=>{Q(S,{children:(G,I)=>{var k=E(),ge=d(k);o(ge,()=>tr,(fe,V)=>{V(fe,{size:"icon-sm",variant:"ghost","aria-label":"去重与清理",onclick:er,children:(Y,Re)=>{Cn(Y,{})},$$slots:{default:!0}})}),t(G,k)},$$slots:{default:!0}})});var _e=r(ce,2);o(_e,()=>xa,(S,Q)=>{Q(S,{children:(G,I)=>{p();var k=m("去重与清理");t(G,k)},$$slots:{default:!0}})}),t(B,F)},$$slots:{default:!0}})});var st=r(Je,2);o(st,()=>$a,(M,R)=>{R(M,{children:(B,Ae)=>{var F=Ad(),ce=d(F);o(ce,()=>ha,(S,Q)=>{Q(S,{children:(G,I)=>{var k=E(),ge=d(k);{let fe=j(()=>!e(Pe).trim());o(ge,()=>tr,(V,Y)=>{Y(V,{size:"icon-sm",variant:"ghost","aria-label":"清空",get disabled(){return e(fe)},onclick:()=>c(Pe,""),children:(Re,K)=>{co(Re,{})},$$slots:{default:!0}})})}t(G,k)},$$slots:{default:!0}})});var _e=r(ce,2);o(_e,()=>xa,(S,Q)=>{Q(S,{children:(G,I)=>{p();var k=m("清空");t(G,k)},$$slots:{default:!0}})}),t(B,F)},$$slots:{default:!0}})});var Et=r(st,2);o(Et,()=>$a,(M,R)=>{R(M,{children:(B,Ae)=>{var F=Ld(),ce=d(F);o(ce,()=>ha,(S,Q)=>{Q(S,{children:(G,I)=>{var k=E(),ge=d(k);{let fe=j(()=>!e(Pe).trim()||e(yt));o(ge,()=>tr,(V,Y)=>{Y(V,{variant:"outline",size:"sm","aria-label":"保存为新集合",get disabled(){return e(fe)},onclick:vr,children:(Re,K)=>{p();var oe=m("保存为新集合");t(Re,oe)},$$slots:{default:!0}})})}t(G,k)},$$slots:{default:!0}})});var _e=r(ce,2);o(_e,()=>xa,(S,Q)=>{Q(S,{children:(G,I)=>{p();var k=m("保存为新集合");t(G,k)},$$slots:{default:!0}})}),t(B,F)},$$slots:{default:!0}})});var xe=r(Et,2);o(xe,()=>$a,(M,R)=>{R(M,{children:(B,Ae)=>{var F=jd(),ce=d(F);o(ce,()=>ha,(S,Q)=>{Q(S,{children:(G,I)=>{var k=E(),ge=d(k);o(ge,()=>tr,(fe,V)=>{V(fe,{variant:"ghost",size:"sm","aria-label":"资产地址库",onclick:Y=>{Y.stopPropagation(),c(Jr,!0),c(Ht,!1)},children:(Y,Re)=>{p();var K=m("资产地址库");t(Y,K)},$$slots:{default:!0}})}),t(G,k)},$$slots:{default:!0}})});var _e=r(ce,2);o(_e,()=>xa,(S,Q)=>{Q(S,{children:(G,I)=>{p();var k=m("打开资产地址库");t(G,k)},$$slots:{default:!0}})}),t(B,F)},$$slots:{default:!0}})});var Ue=r(xe,2);o(Ue,()=>bl,(M,R)=>{R(M,{class:"ms-auto",children:(B,Ae)=>{p();var F=m();P(()=>b(F,`资产列表 · ${e(At)??""} 条`)),t(B,F)},$$slots:{default:!0}})}),t(se,zt)},$$slots:{default:!0}})});var Z=r(_,2);o(Z,()=>Pl,(g,ae)=>{ae(g,{rows:10,class:"h-[200px] w-full resize-none overflow-auto",style:"scrollbar-gutter: stable",get value(){return e(Pe)},set value(se){c(Pe,se,!0)},get ref(){return e(Ut)},set ref(se){c(Ut,se,!0)}})}),t(D,H)},$$slots:{default:!0}})}),t(we,re)},$$slots:{default:!0}})}),t(Ie,Te)},$$slots:{default:!0}})}),a(Ee),a(et),a(yr),a(gr),a(He),a(wt),P(de=>{kt=Rr(gr,1,"relative overflow-hidden rounded-t-lg border bg-background shadow-lg",null,kt,de),Hs(gr,`height: ${e($)*100}vh`),Rr(Ze,1,`flex flex-col border-r ${e(Lt)?"w-20":"w-72"}`,"svelte-1k5an9e"),Rr(it,1,`flex items-center ${e(Lt)?"justify-center":"justify-between"} p-2`,"svelte-1k5an9e")},[()=>({"select-none":e(qa)})]),t(ot,wt)};A(ro,ot=>{e(f)&&ot(dn)})}var ao=r(ro,2);o(ao,()=>fs,(ot,wt)=>{wt(ot,{get open(){return e(Dr)},set open(He){c(Dr,He,!0)},children:(He,gr)=>{var kt=yc(),Ot=d(kt);o(Ot,()=>Es,(Ze,it)=>{it(Ze,{})});var yr=r(Ot,2);o(yr,()=>ps,(Ze,it)=>{it(Ze,{side:"bottom",class:"",children:(Tr,Mr)=>{var ht=bc(),Wt=s(ht);o(Wt,()=>Os,(et,J)=>{J(et,{children:(W,tt)=>{var te=Bd(),he=d(te);o(he,()=>Bs,(dt,ke)=>{ke(dt,{children:(Mt,nt)=>{p();var ct=m("扫描策略");t(Mt,ct)},$$slots:{default:!0}})});var je=r(he,2);o(je,()=>Fs,(dt,ke)=>{ke(dt,{children:(Mt,nt)=>{p();var ct=m("仅本次扫描的参数组合，支持保存为策略");t(Mt,ct)},$$slots:{default:!0}})}),t(W,te)},$$slots:{default:!0}})});var Xt=r(Wt,2),ft=s(Xt);o(ft,()=>tl,(et,J)=>{J(et,{"aria-label":"策略管理",children:(W,tt)=>{var te=Gd(),he=d(te);{let nt=j(()=>Tt.activeId??void 0);o(he,()=>_s,(ct,Ee)=>{Ee(ct,{type:"single",get value(){return e(nt)},onValueChange:Ft=>qs(Ft),children:(Ft,de)=>{var me=Dd(),Ie=d(me);o(Ie,()=>gs,(Te,Ce)=>{Ce(Te,{size:"sm","aria-label":"选择扫描策略",children:(pt,Oe)=>{var $e=Fd(),we=s($e,!0);a($e),P(Qe=>b(we,Qe),[()=>Tt.getActive()?.name??Tt.activeId]),t(pt,$e)},$$slots:{default:!0}})});var xt=r(Ie,2);o(xt,()=>ms,(Te,Ce)=>{Ce(Te,{class:"min-w-40",children:(pt,Oe)=>{var $e=E(),we=d($e);Zt(we,17,()=>Tt.strategies,Qe=>Qe.id,(Qe,re)=>{var Se=E(),Fe=d(Se);o(Fe,()=>Qr,(z,D)=>{D(z,{get value(){return e(re).id},children:(ue,H)=>{var _=Rd(),Z=s(_,!0);a(_),P(()=>b(Z,e(re).name)),t(ue,_)},$$slots:{default:!0}})}),t(Qe,Se)}),t(pt,$e)},$$slots:{default:!0}})}),t(Ft,me)},$$slots:{default:!0}})})}var je=r(he,2);X(je,{size:"sm",variant:"outline",onclick:os,children:(nt,ct)=>{p();var Ee=m("新建策略");t(nt,Ee)},$$slots:{default:!0}});var dt=r(je,2);X(dt,{size:"sm",variant:"outline",onclick:Ao,children:(nt,ct)=>{p();var Ee=m("复制");t(nt,Ee)},$$slots:{default:!0}});var ke=r(dt,2);X(ke,{size:"sm",variant:"outline",onclick:()=>{const nt=Tt.getActive();if(!nt){Be.error("未选择策略");return}const Ee=(prompt("重命名为",nt.name)||"").trim();Ee&&(Tt.rename(nt.id,Ee),Be.success(`已重命名为：${Ee}`))},children:(nt,ct)=>{p();var Ee=m("重命名");t(nt,Ee)},$$slots:{default:!0}});var Mt=r(ke,2);o(Mt,()=>zs,(nt,ct)=>{ct(nt,{get open(){return e(ra)},set open(Ee){c(ra,Ee,!0)},children:(Ee,Ft)=>{var de=qd(),me=d(de);{let xt=j(()=>Zn({variant:"destructive",size:"sm"}));o(me,()=>rl,(Te,Ce)=>{Ce(Te,{get class(){return e(xt)},children:(pt,Oe)=>{p();var $e=m("删除");t(pt,$e)},$$slots:{default:!0}})})}var Ie=r(me,2);o(Ie,()=>xs,(xt,Te)=>{Te(xt,{children:(Ce,pt)=>{var Oe=Ud(),$e=d(Oe);o($e,()=>bs,(Qe,re)=>{re(Qe,{children:(Se,Fe)=>{var z=Hd(),D=d(z);o(D,()=>ys,(H,_)=>{_(H,{children:(Z,g)=>{p();var ae=m("确认删除策略?");t(Z,ae)},$$slots:{default:!0}})});var ue=r(D,2);o(ue,()=>Ps,(H,_)=>{_(H,{children:(Z,g)=>{p();var ae=m();P(se=>b(ae,`此操作不可恢复，将删除当前策略 "${se??""}"`),[()=>Tt.getActive()?.name]),t(Z,ae)},$$slots:{default:!0}})}),t(Se,z)},$$slots:{default:!0}})});var we=r($e,2);o(we,()=>ws,(Qe,re)=>{re(Qe,{children:(Se,Fe)=>{var z=Qd(),D=d(z);o(D,()=>ks,(H,_)=>{_(H,{children:(Z,g)=>{p();var ae=m("取消");t(Z,ae)},$$slots:{default:!0}})});var ue=r(D,2);o(ue,()=>Ss,(H,_)=>{_(H,{onclick:()=>{Lo(),c(ra,!1)},children:(Z,g)=>{p();var ae=m("删除");t(Z,ae)},$$slots:{default:!0}})}),t(Se,z)},$$slots:{default:!0}})}),t(Ce,Oe)},$$slots:{default:!0}})}),t(Ee,de)},$$slots:{default:!0}})}),t(W,te)},$$slots:{default:!0}})});var Bt=r(ft,2);X(Bt,{size:"sm",variant:"default",onclick:jo,children:(et,J)=>{var W=Vd(),tt=d(W);zn(tt,{class:"mr-1 size-4"}),p(),t(et,W)},$$slots:{default:!0}}),a(Xt);var St=r(Xt,2);o(St,()=>ko,(et,J)=>{J(et,{get value(){return e(Ea)},onValueChange:W=>c(Ea,W,!0),children:(W,tt)=>{var te=xc(),he=d(te);o(he,()=>So,(dt,ke)=>{ke(dt,{class:"grid grid-cols-3 gap-2",children:(Mt,nt)=>{var ct=Wd(),Ee=d(ct);o(Ee,()=>Xa,(me,Ie)=>{Ie(me,{value:"performance",children:(xt,Te)=>{p();var Ce=m("性能与稳定性");t(xt,Ce)},$$slots:{default:!0}})});var Ft=r(Ee,2);o(Ft,()=>Xa,(me,Ie)=>{Ie(me,{value:"http",children:(xt,Te)=>{p();var Ce=m("HTTP 与请求");t(xt,Ce)},$$slots:{default:!0}})});var de=r(Ft,2);o(de,()=>Xa,(me,Ie)=>{Ie(me,{value:"oob",children:(xt,Te)=>{p();var Ce=m("OOB");t(xt,Ce)},$$slots:{default:!0}})}),t(Mt,ct)},$$slots:{default:!0}})});var je=r(he,2);o(je,()=>ja,(dt,ke)=>{ke(dt,{class:"mt-2 h-[60vh]",children:(Mt,nt)=>{var ct=hc(),Ee=d(ct);o(Ee,()=>La,(de,me)=>{me(de,{class:"h-full w-full",children:(Ie,xt)=>{var Te=$c(),Ce=d(Te);o(Ce,()=>Rs,(Fe,z)=>{z(Fe,{value:"performance",class:"space-y-4",children:(D,ue)=>{var H=ac(),_=d(H),Z=s(_),g=s(Z);rs(g,{id:"perf-smart",get checked(){return e(h).performance.smart},onCheckedChange:I=>e(h).performance.smart=I}),p(2),a(Z),a(_);var ae=r(_,2),se=s(ae),Nt=s(se),zt=r(s(Nt),2);o(zt,()=>Aa,(I,k)=>{k(I,{class:"w-[160px]",get"data-disabled"(){return e(h).performance.smart},children:(ge,fe)=>{var V=Jd(),Y=d(V);o(Y,()=>Wa,(K,oe)=>{oe(K,{id:"perf-rl",type:"number",min:"1",get disabled(){return e(h).performance.smart},get value(){return e(h).performance.rateLimit},set value(O){e(h).performance.rateLimit=O}})});var Re=r(Y,2);o(Re,()=>ma,(K,oe)=>{oe(K,{align:"inline-end",children:(O,_t)=>{var De=Kd(),qe=d(De);o(qe,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.rateLimit=Math.max(1,Number(e(h).performance.rateLimit||0)-1),children:(ve,ee)=>{Ha(ve,{})},$$slots:{default:!0}})});var Rt=r(qe,2);o(Rt,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.rateLimit=Math.max(1,Number(e(h).performance.rateLimit||0)+1),children:(ve,ee)=>{Ta(ve,{})},$$slots:{default:!0}})}),t(O,De)},$$slots:{default:!0}})}),t(ge,V)},$$slots:{default:!0}})}),a(Nt);var Me=r(Nt,2),Je=r(s(Me),2);o(Je,()=>Aa,(I,k)=>{k(I,{class:"w-[160px]",get"data-disabled"(){return e(h).performance.smart},children:(ge,fe)=>{var V=Xd(),Y=d(V);o(Y,()=>Wa,(K,oe)=>{oe(K,{id:"perf-c",type:"number",min:"1",get disabled(){return e(h).performance.smart},get value(){return e(h).performance.concurrency},set value(O){e(h).performance.concurrency=O}})});var Re=r(Y,2);o(Re,()=>ma,(K,oe)=>{oe(K,{align:"inline-end",children:(O,_t)=>{var De=Yd(),qe=d(De);o(qe,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.concurrency=Math.max(1,Number(e(h).performance.concurrency||0)-1),children:(ve,ee)=>{Ha(ve,{})},$$slots:{default:!0}})});var Rt=r(qe,2);o(Rt,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(h).performance.smart},onclick:()=>e(h).performance.concurrency=Math.max(1,Number(e(h).performance.concurrency||0)+1),children:(ve,ee)=>{Ta(ve,{})},$$slots:{default:!0}})}),t(O,De)},$$slots:{default:!0}})}),t(ge,V)},$$slots:{default:!0}})}),a(Me),a(se),a(ae);var st=r(ae,2),Et=r(s(st),2);o(Et,()=>Aa,(I,k)=>{k(I,{class:"w-[160px]",children:(ge,fe)=>{var V=ec(),Y=d(V);o(Y,()=>Wa,(K,oe)=>{oe(K,{id:"perf-timeout",type:"number",min:"1",get value(){return e(h).performance.timeout},set value(O){e(h).performance.timeout=O}})});var Re=r(Y,2);o(Re,()=>ma,(K,oe)=>{oe(K,{align:"inline-end",children:(O,_t)=>{var De=Zd(),qe=d(De);o(qe,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"减少",onclick:()=>e(h).performance.timeout=Math.max(1,Number(e(h).performance.timeout||0)-1),children:(ve,ee)=>{Ha(ve,{})},$$slots:{default:!0}})});var Rt=r(qe,2);o(Rt,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"增加",onclick:()=>e(h).performance.timeout=Math.max(1,Number(e(h).performance.timeout||0)+1),children:(ve,ee)=>{Ta(ve,{})},$$slots:{default:!0}})}),t(O,De)},$$slots:{default:!0}})}),t(ge,V)},$$slots:{default:!0}})}),a(st);var xe=r(st,2),Ue=r(s(xe),2);o(Ue,()=>Aa,(I,k)=>{k(I,{class:"w-[160px]",children:(ge,fe)=>{var V=rc(),Y=d(V);o(Y,()=>Wa,(K,oe)=>{oe(K,{id:"perf-retries",type:"number",min:"0",get value(){return e(h).performance.retries},set value(O){e(h).performance.retries=O}})});var Re=r(Y,2);o(Re,()=>ma,(K,oe)=>{oe(K,{align:"inline-end",children:(O,_t)=>{var De=tc(),qe=d(De);o(qe,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"减少",onclick:()=>e(h).performance.retries=Math.max(0,Number(e(h).performance.retries||0)-1),children:(ve,ee)=>{Ha(ve,{})},$$slots:{default:!0}})});var Rt=r(qe,2);o(Rt,()=>tr,(We,N)=>{N(We,{size:"icon-sm",variant:"ghost","aria-label":"增加",onclick:()=>e(h).performance.retries=Math.max(0,Number(e(h).performance.retries||0)+1),children:(ve,ee)=>{Ta(ve,{})},$$slots:{default:!0}})}),t(O,De)},$$slots:{default:!0}})}),t(ge,V)},$$slots:{default:!0}})}),a(xe);var M=r(xe,2),R=r(s(M),2),B=s(R),Ae=s(B);rs(Ae,{id:"perf-web-fingerprint",get checked(){return e(h).performance.webFingerprint},onCheckedChange:I=>e(h).performance.webFingerprint=I}),p(2),a(B);var F=r(B,2),ce=s(F);rs(ce,{id:"perf-port-scan",get checked(){return e(h).performance.portScan},onCheckedChange:I=>e(h).performance.portScan=I}),p(2),a(F);var _e=r(F,2),S=r(s(_e),2);da(S,{id:"perf-ports",placeholder:"1-65535 或 80,443,8080",get value(){return e(h).performance.ports},set value(I){e(h).performance.ports=I}}),a(_e);var Q=r(_e,2),G=s(Q);rs(G,{id:"perf-skip-host-discovery",get checked(){return e(h).performance.skipHostDiscovery},onCheckedChange:I=>e(h).performance.skipHostDiscovery=I}),p(2),a(Q),a(R),a(M),t(D,H)},$$slots:{default:!0}})});var pt=r(Ce,2);o(pt,()=>Rs,(Fe,z)=>{z(Fe,{value:"http",class:"space-y-4",children:(D,ue)=>{var H=dc(),_=s(H),Z=r(s(_),2);da(Z,{id:"http-proxy",placeholder:"http://127.0.0.1:1080",get value(){return e(h).http.proxy},set value(xe){e(h).http.proxy=xe}}),a(_);var g=r(_,2),ae=r(s(g),2),se=s(ae);Zt(se,17,()=>e(h).http.headers??[],Qs,(xe,Ue,M)=>{var R=sc(),B=s(R);da(B,{class:"flex-1",placeholder:"Header: Value",get title(){return e(Ue)},get value(){return e(h).http.headers[M]},set value(F){e(h).http.headers[M]=F}});var Ae=r(B,2);X(Ae,{size:"sm",variant:"outline",onclick:()=>e(h).http.headers=(e(h).http.headers||[]).filter((F,ce)=>ce!==M),children:(F,ce)=>{p();var _e=m("删除");t(F,_e)},$$slots:{default:!0}}),a(R),t(xe,R)});var Nt=r(se,2),zt=s(Nt);X(zt,{size:"sm",variant:"outline",onclick:()=>e(h).http.headers=[...e(h).http.headers||[],""],children:(xe,Ue)=>{p();var M=m("新增头部");t(xe,M)},$$slots:{default:!0}}),a(Nt),a(ae),a(g);var Me=r(g,2),Je=r(s(Me),2);{let xe=j(()=>e(h).http.sort??"");o(Je,()=>_s,(Ue,M)=>{M(Ue,{type:"single",get value(){return e(xe)},onValueChange:R=>e(h).http.sort=R,children:(R,B)=>{var Ae=lc(),F=d(Ae);o(F,()=>gs,(_e,S)=>{S(_e,{size:"sm",id:"http-sort",children:(Q,G)=>{var I=oc(),k=s(I,!0);a(I),P(()=>b(k,e(h).http.sort==="a-z"?"按字母顺序":"默认严重级")),t(Q,I)},$$slots:{default:!0}})});var ce=r(F,2);o(ce,()=>ms,(_e,S)=>{S(_e,{class:"min-w-40",children:(Q,G)=>{var I=nc(),k=d(I);o(k,()=>Qr,(fe,V)=>{V(fe,{value:"",children:(Y,Re)=>{p();var K=m("默认严重级");t(Y,K)},$$slots:{default:!0}})});var ge=r(k,2);o(ge,()=>Qr,(fe,V)=>{V(fe,{value:"a-z",children:(Y,Re)=>{p();var K=m("按字母顺序");t(Y,K)},$$slots:{default:!0}})}),t(Q,I)},$$slots:{default:!0}})}),t(R,Ae)},$$slots:{default:!0}})})}a(Me);var st=r(Me,2),Et=r(s(st),2);Zt(Et,20,()=>x,xe=>xe,(xe,Ue)=>{var M=ic(),R=s(M);_o(R,{get checked(){return C[Ue]},set checked(F){C[Ue]=F}});var B=r(R,2),Ae=s(B,!0);a(B),a(M),P(()=>b(Ae,Ue)),t(xe,M)}),a(Et),a(st),a(H),t(D,H)},$$slots:{default:!0}})});var Oe=r(pt,2);o(Oe,()=>Rs,(Fe,z)=>{z(Fe,{value:"oob",class:"space-y-4",children:(D,ue)=>{var H=mc(),_=s(H),Z=r(s(_),2);{let Je=j(()=>e(h).oob.adapter??"");o(Z,()=>_s,(st,Et)=>{Et(st,{type:"single",get value(){return e(Je)},onValueChange:xe=>e(h).oob.adapter=xe,children:(xe,Ue)=>{var M=uc(),R=d(M);o(R,()=>gs,(Ae,F)=>{F(Ae,{size:"sm",children:(ce,_e)=>{var S=cc(),Q=s(S,!0);a(S),P(()=>b(Q,e(h).oob.adapter||"请选择适配器")),t(ce,S)},$$slots:{default:!0}})});var B=r(R,2);o(B,()=>ms,(Ae,F)=>{F(Ae,{class:"min-w-40",children:(ce,_e)=>{var S=vc(),Q=d(S);o(Q,()=>Qr,(fe,V)=>{V(fe,{value:"ceye",children:(Y,Re)=>{p();var K=m("ceye");t(Y,K)},$$slots:{default:!0}})});var G=r(Q,2);o(G,()=>Qr,(fe,V)=>{V(fe,{value:"dnslogcn",children:(Y,Re)=>{p();var K=m("dnslogcn");t(Y,K)},$$slots:{default:!0}})});var I=r(G,2);o(I,()=>Qr,(fe,V)=>{V(fe,{value:"alphalog",children:(Y,Re)=>{p();var K=m("alphalog");t(Y,K)},$$slots:{default:!0}})});var k=r(I,2);o(k,()=>Qr,(fe,V)=>{V(fe,{value:"xray",children:(Y,Re)=>{p();var K=m("xray");t(Y,K)},$$slots:{default:!0}})});var ge=r(k,2);o(ge,()=>Qr,(fe,V)=>{V(fe,{value:"revsuit",children:(Y,Re)=>{p();var K=m("revsuit");t(Y,K)},$$slots:{default:!0}})}),t(ce,S)},$$slots:{default:!0}})}),t(xe,M)},$$slots:{default:!0}})})}a(_);var g=r(_,2),ae=s(g),se=s(ae),Nt=r(s(se),2);{let Je=j(()=>!e(h).oob.adapter);o(Nt,()=>Aa,(st,Et)=>{Et(st,{class:"w-[160px]",get"data-disabled"(){return e(Je)},children:(xe,Ue)=>{var M=pc(),R=d(M);{let Ae=j(()=>!e(h).oob.adapter);o(R,()=>Wa,(F,ce)=>{ce(F,{id:"oob-rl",type:"number",min:"1",get disabled(){return e(Ae)},get value(){return e(h).oob.rateLimit},set value(_e){e(h).oob.rateLimit=_e}})})}var B=r(R,2);o(B,()=>ma,(Ae,F)=>{F(Ae,{align:"inline-end",children:(ce,_e)=>{var S=fc(),Q=d(S);{let I=j(()=>!e(h).oob.adapter);o(Q,()=>tr,(k,ge)=>{ge(k,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(I)},onclick:()=>e(h).oob.rateLimit=Math.max(1,Number(e(h).oob.rateLimit||0)-1),children:(fe,V)=>{Ha(fe,{})},$$slots:{default:!0}})})}var G=r(Q,2);{let I=j(()=>!e(h).oob.adapter);o(G,()=>tr,(k,ge)=>{ge(k,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(I)},onclick:()=>e(h).oob.rateLimit=Math.max(1,Number(e(h).oob.rateLimit||0)+1),children:(fe,V)=>{Ta(fe,{})},$$slots:{default:!0}})})}t(ce,S)},$$slots:{default:!0}})}),t(xe,M)},$$slots:{default:!0}})})}a(se);var zt=r(se,2),Me=r(s(zt),2);{let Je=j(()=>!e(h).oob.adapter);o(Me,()=>Aa,(st,Et)=>{Et(st,{class:"w-[160px]",get"data-disabled"(){return e(Je)},children:(xe,Ue)=>{var M=gc(),R=d(M);{let Ae=j(()=>!e(h).oob.adapter);o(R,()=>Wa,(F,ce)=>{ce(F,{id:"oob-c",type:"number",min:"1",get disabled(){return e(Ae)},get value(){return e(h).oob.concurrency},set value(_e){e(h).oob.concurrency=_e}})})}var B=r(R,2);o(B,()=>ma,(Ae,F)=>{F(Ae,{align:"inline-end",children:(ce,_e)=>{var S=_c(),Q=d(S);{let I=j(()=>!e(h).oob.adapter);o(Q,()=>tr,(k,ge)=>{ge(k,{size:"icon-sm",variant:"ghost","aria-label":"减少",get disabled(){return e(I)},onclick:()=>e(h).oob.concurrency=Math.max(1,Number(e(h).oob.concurrency||0)-1),children:(fe,V)=>{Ha(fe,{})},$$slots:{default:!0}})})}var G=r(Q,2);{let I=j(()=>!e(h).oob.adapter);o(G,()=>tr,(k,ge)=>{ge(k,{size:"icon-sm",variant:"ghost","aria-label":"增加",get disabled(){return e(I)},onclick:()=>e(h).oob.concurrency=Math.max(1,Number(e(h).oob.concurrency||0)+1),children:(fe,V)=>{Ta(fe,{})},$$slots:{default:!0}})})}t(ce,S)},$$slots:{default:!0}})}),t(xe,M)},$$slots:{default:!0}})})}a(zt),a(ae),a(g),a(H),t(D,H)},$$slots:{default:!0}})});var $e=r(Oe,2),we=r(s($e),2),Qe=s(we,!0);a(we);var re=r(we,2),Se=s(re);X(Se,{size:"sm",onclick:()=>navigator.clipboard?.writeText(Tt.toCommandString(Tt.diffAgainstBaseline(e(h)))),children:(Fe,z)=>{p();var D=m("复制命令");t(Fe,D)},$$slots:{default:!0}}),a(re),a($e),P(Fe=>b(Qe,Fe),[()=>Tt.toCommandString(Tt.diffAgainstBaseline(e(h)))]),t(Ie,Te)},$$slots:{default:!0}})});var Ft=r(Ee,2);o(Ft,()=>ya,(de,me)=>{me(de,{orientation:"vertical",children:(Ie,xt)=>{var Te=E(),Ce=d(Te);o(Ce,()=>Pa,(pt,Oe)=>{Oe(pt,{})}),t(Ie,Te)},$$slots:{default:!0}})}),t(Mt,ct)},$$slots:{default:!0}})}),t(W,te)},$$slots:{default:!0}})}),a(ht),t(Tr,ht)},$$slots:{default:!0}})}),t(He,kt)},$$slots:{default:!0}})});var so=r(ao,2);o(so,()=>fs,(ot,wt)=>{wt(ot,{get open(){return e(Cs)},set open(He){c(Cs,He,!0)},children:(He,gr)=>{var kt=Ac(),Ot=d(kt);o(Ot,()=>Es,(Ze,it)=>{it(Ze,{})});var yr=r(Ot,2);o(yr,()=>ps,(Ze,it)=>{it(Ze,{side:"bottom",class:"",children:(Tr,Mr)=>{var ht=Cc(),Wt=s(ht);o(Wt,()=>Os,(z,D)=>{D(z,{children:(ue,H)=>{var _=Pc(),Z=d(_);o(Z,()=>Bs,(ae,se)=>{se(ae,{children:(Nt,zt)=>{p();var Me=m("选择 PoC");t(Nt,Me)},$$slots:{default:!0}})});var g=r(Z,2);o(g,()=>Fs,(ae,se)=>{se(ae,{children:(Nt,zt)=>{p();var Me=m("左侧搜索选择，右侧为已选；右侧为空=默认扫描全部");t(Nt,Me)},$$slots:{default:!0}})}),t(ue,_)},$$slots:{default:!0}})});var Xt=r(Wt,2),ft=s(Xt),Bt=s(ft),St=s(Bt);da(St,{class:"flex-1",placeholder:"搜索 PoC",onkeydown:z=>{z.key==="Enter"&&Gs()},get value(){return e(ns)},set value(z){c(ns,z,!0)}});var et=r(St,2);X(et,{size:"sm",variant:"outline",onclick:Gs,children:(z,D)=>{p();var ue=m("搜索");t(z,ue)},$$slots:{default:!0}});var J=r(et,2);X(J,{size:"sm",variant:"ghost",onclick:Do,children:(z,D)=>{p();var ue=m("全选");t(z,ue)},$$slots:{default:!0}});var W=r(J,2);X(W,{size:"sm",variant:"ghost",onclick:Ho,children:(z,D)=>{p();var ue=m("取消全选");t(z,ue)},$$slots:{default:!0}});var tt=r(W,2);X(tt,{size:"sm",onclick:qo,children:(z,D)=>{p();var ue=m("追加所选");t(z,ue)},$$slots:{default:!0}}),a(Bt);var te=r(Bt,2),he=s(te);{var je=z=>{var D=wc();t(z,D)},dt=z=>{var D=E(),ue=d(D);Zt(ue,19,()=>e(Oa),(H,_)=>H.poc_id||String(H.id??_),(H,_)=>{var Z=zc();Z.__click=[kc,js,_],Z.__keydown=[Sc,js,_];var g=s(Z),ae=s(g);{let xe=j(()=>Sa.has(e(_)?.poc_id||String(e(_)?.id||"")));_o(ae,{get checked(){return e(xe)},onclick:Ue=>{Ue.stopPropagation(),js(e(_))}})}var se=r(ae,2),Nt=s(se,!0);a(se);var zt=r(se,2);fa(zt,{variant:"outline",children:(xe,Ue)=>{p();var M=m();P(R=>b(M,R),[()=>(e(_).severity||"").toString().toUpperCase()]),t(xe,M)},$$slots:{default:!0}}),a(g);var Me=r(g,2),Je=s(Me),st=s(Je,!0);a(Je);var Et=r(Je,2);X(Et,{variant:"outline",size:"sm",onclick:()=>Go(e(_)),children:(xe,Ue)=>{p();var M=m("追加");t(xe,M)},$$slots:{default:!0}}),a(Me),a(Z),P(()=>{b(Nt,e(_).name),b(st,e(_).poc_id)}),t(H,Z)}),t(z,D)};A(he,z=>{(e(Oa)?.length||0)===0?z(je):z(dt,!1)})}a(te);var ke=r(te,2),Mt=s(ke),nt=s(Mt);a(Mt);var ct=r(Mt,2),Ee=s(ct);{let z=j(()=>e(ga)<=1);X(Ee,{size:"sm",variant:"ghost",onclick:Fo,get disabled(){return e(z)},children:(D,ue)=>{p();var H=m("上一页");t(D,H)},$$slots:{default:!0}})}var Ft=r(Ee,2),de=s(Ft);a(Ft);var me=r(Ft,2);{let z=j(()=>e(ga)>=e(As));X(me,{size:"sm",variant:"ghost",onclick:Ro,get disabled(){return e(z)},children:(D,ue)=>{p();var H=m("下一页");t(D,H)},$$slots:{default:!0}})}var Ie=r(me,2),xt=s(Ie);da(xt,{class:"h-8 w-20",placeholder:"每页",onkeydown:z=>{z.key==="Enter"&&Ws()},get value(){return e(is)},set value(z){c(is,z,!0)}});var Te=r(xt,2);X(Te,{size:"sm",variant:"outline",onclick:Ws,children:(z,D)=>{p();var ue=m("应用");t(z,ue)},$$slots:{default:!0}}),a(Ie),a(ct),a(ke),a(ft);var Ce=r(ft,2),pt=s(Ce),Oe=s(pt),$e=s(Oe);a(Oe);var we=r(Oe,2);X(we,{size:"sm",variant:"outline",onclick:()=>e(u)&&Ne.clearTaskPocs(e(u).id),children:(z,D)=>{p();var ue=m("清空");t(z,ue)},$$slots:{default:!0}}),a(pt);var Qe=r(pt,2),re=s(Qe);{var Se=z=>{var D=E(),ue=d(D);Zt(ue,19,()=>e(u).pocs,(H,_)=>H.id||_,(H,_)=>{var Z=Ic(),g=s(Z),ae=s(g),se=s(ae,!0);a(ae);var Nt=r(ae,2);fa(Nt,{variant:"outline",children:(Me,Je)=>{p();var st=m();P(Et=>b(st,Et),[()=>(e(_).severity||"").toString().toUpperCase()]),t(Me,st)},$$slots:{default:!0}}),a(g);var zt=r(g,2);X(zt,{variant:"ghost",size:"icon-sm","aria-label":"移除",onclick:()=>e(u)&&Ne.removeTaskPoc(e(u).id,e(_).id),children:(Me,Je)=>{vo(Me,{class:"size-3"})},$$slots:{default:!0}}),a(Z),P(()=>b(se,e(_).name)),t(H,Z)}),t(z,D)},Fe=z=>{var D=Tc();t(z,D)};A(re,z=>{e(u)?.pocs&&e(u).pocs.length>0?z(Se):z(Fe,!1)})}a(Qe),a(Ce),a(Xt),a(ht),P(()=>{b(nt,`共 ${e(Za)??""} 条 · 每页 ${e(ls)??""}`),b(de,`第 ${e(ga)??""} / 共 ${e(As)??""} 页`),b($e,`已选 ${(e(u)?.pocs?.length||0)??""} 个PoC（右侧为空=默认扫描全部）`)}),t(Tr,ht)},$$slots:{default:!0}})}),t(He,kt)},$$slots:{default:!0}})});var oo=r(so,2);o(oo,()=>fs,(ot,wt)=>{wt(ot,{get open(){return e(Jr)},set open(He){c(Jr,He,!0)},children:(He,gr)=>{var kt=Mc(),Ot=d(kt);o(Ot,()=>Es,(Ze,it)=>{it(Ze,{})});var yr=r(Ot,2);o(yr,()=>ps,(Ze,it)=>{it(Ze,{side:"bottom",class:"",children:(Tr,Mr)=>{var ht=jc(),Wt=s(ht);o(Wt,()=>Os,(ft,Bt)=>{Bt(ft,{children:(St,et)=>{var J=Lc(),W=d(J);o(W,()=>Bs,(te,he)=>{he(te,{children:(je,dt)=>{p();var ke=m("资产地址库");t(je,ke)},$$slots:{default:!0}})});var tt=r(W,2);o(tt,()=>Fs,(te,he)=>{he(te,{children:(je,dt)=>{p();var ke=m("导入与复用历史资产");t(je,ke)},$$slots:{default:!0}})}),t(St,J)},$$slots:{default:!0}})});var Xt=r(Wt,2);Yl(Xt,{height:"60vh",onAdd:Oo}),a(ht),t(Tr,ht)},$$slots:{default:!0}})}),t(He,kt)},$$slots:{default:!0}})});var no=r(oo,2);o(no,()=>zs,(ot,wt)=>{wt(ot,{get open(){return e(Ir)},set open(He){c(Ir,He,!0)},children:(He,gr)=>{var kt=Bc(),Ot=d(kt);o(Ot,()=>go,(Ze,it)=>{it(Ze,{})});var yr=r(Ot,2);o(yr,()=>xs,(Ze,it)=>{it(Ze,{children:(Tr,Mr)=>{var ht=Oc(),Wt=d(ht);o(Wt,()=>bs,(ft,Bt)=>{Bt(ft,{children:(St,et)=>{var J=Nc(),W=d(J);o(W,()=>ys,(te,he)=>{he(te,{children:(je,dt)=>{p();var ke=m();P(()=>b(ke,e(Ar))),t(je,ke)},$$slots:{default:!0}})});var tt=r(W,2);o(tt,()=>Ps,(te,he)=>{he(te,{children:(je,dt)=>{p();var ke=m();P(()=>b(ke,e(Kr))),t(je,ke)},$$slots:{default:!0}})}),t(St,J)},$$slots:{default:!0}})});var Xt=r(Wt,2);o(Xt,()=>ws,(ft,Bt)=>{Bt(ft,{children:(St,et)=>{var J=Ec(),W=d(J);o(W,()=>ks,(te,he)=>{he(te,{onclick:()=>{c(Ir,!1)},children:(je,dt)=>{p();var ke=m("取消");t(je,ke)},$$slots:{default:!0}})});var tt=r(W,2);o(tt,()=>Ss,(te,he)=>{he(te,{onclick:()=>{No()},children:(je,dt)=>{p();var ke=m("继续");t(je,ke)},$$slots:{default:!0}})}),t(St,J)},$$slots:{default:!0}})}),t(Tr,ht)},$$slots:{default:!0}})}),t(He,kt)},$$slots:{default:!0}})});var cn=r(no,2);o(cn,()=>zs,(ot,wt)=>{wt(ot,{get open(){return e(Ga)},set open(He){c(Ga,He,!0)},children:(He,gr)=>{var kt=Hc(),Ot=d(kt);o(Ot,()=>go,(Ze,it)=>{it(Ze,{})});var yr=r(Ot,2);o(yr,()=>xs,(Ze,it)=>{it(Ze,{children:(Tr,Mr)=>{var ht=Dc(),Wt=d(ht);o(Wt,()=>bs,(ft,Bt)=>{Bt(ft,{children:(St,et)=>{var J=Fc(),W=d(J);o(W,()=>ys,(te,he)=>{he(te,{children:(je,dt)=>{p();var ke=m("确认删除任务?");t(je,ke)},$$slots:{default:!0}})});var tt=r(W,2);o(tt,()=>Ps,(te,he)=>{he(te,{children:(je,dt)=>{p();var ke=m("删除后将清理该任务的事件流、日志与命中记录。");t(je,ke)},$$slots:{default:!0}})}),t(St,J)},$$slots:{default:!0}})});var Xt=r(Wt,2);o(Xt,()=>ws,(ft,Bt)=>{Bt(ft,{children:(St,et)=>{var J=Rc(),W=d(J);o(W,()=>ks,(te,he)=>{he(te,{get disabled(){return e(za)},onclick:()=>{c(Ga,!1),c(Ba,"")},children:(je,dt)=>{p();var ke=m("取消");t(je,ke)},$$slots:{default:!0}})});var tt=r(W,2);o(tt,()=>Ss,(te,he)=>{he(te,{get disabled(){return e(za)},onclick:Uo,children:(je,dt)=>{var ke=E(),Mt=d(ke);{var nt=Ee=>{var Ft=m("正在停止...");t(Ee,Ft)},ct=Ee=>{var Ft=m("删除");t(Ee,Ft)};A(Mt,Ee=>{e(za)?Ee(nt):Ee(ct,!1)})}t(je,ke)},$$slots:{default:!0}})}),t(St,J)},$$slots:{default:!0}})}),t(Tr,ht)},$$slots:{default:!0}})}),t(He,kt)},$$slots:{default:!0}})}),a(Xe),t(w,Xe)},$$slots:{default:!0}})}),t(y,Xs),dr()}bo(["click","pointerdown","keydown"]);var qc=i("<nav></nav>");function Gc(y,l){ir(l,!0);let f=Er(l,["$$slots","$$events","$$legacy","items","class"]);var $=qc();Ua($,x=>({class:x,...f}),[()=>wr("items-center gap-0.5",l.class)]),Zt($,21,()=>l.items,x=>x.href,(x,C)=>{{let T=j(()=>wr(yo.url.pathname===e(C).href&&"text-primary"));X(x,{get href(){return e(C).href},variant:"ghost",size:"sm",get class(){return e(T)},children:(q,u)=>{p();var Ye=m();P(()=>b(Ye,e(C).title)),t(q,Ye)},$$slots:{default:!0}})}}),a($),t(y,$),dr()}var Vc=En('<svg><path fill="currentColor" d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></svg>');function Wc(y,l){let f=Er(l,["$$slots","$$events","$$legacy"]);var $=Vc();Ua($,()=>({viewBox:"0 0 438.549 438.549",...f})),t(y,$)}const hs=6900;var Kc=i('<!> <span class="w-8 text-xs text-muted-foreground tabular-nums"> </span>',1);function Jc(y,l){ir(l,!0);async function f(){try{return(await(await fetch("https://ungh.cc/repos/zan8in/afrog")).json()).repo?.stars??hs}catch(x){return console.error(x),hs}}let $=L(ba(hs));Ur(()=>{f().then(x=>{c($,x,!0)}).catch(x=>{console.error(x),c($,hs,!0)})}),X(y,{get href(){return sl.links.github},target:"_blank",rel:"noreferrer",size:"sm",variant:"ghost",class:"h-8 shadow-none",children:(x,C)=>{var T=Kc(),q=d(T);Wc(q,{});var u=r(q,2),Ye=s(u,!0);a(u),P(mt=>b(Ye,mt),[()=>e($)>=1e3?`${(e($)/1e3).toFixed(1)}k`:e($).toLocaleString()]),t(x,T)},$$slots:{default:!0}}),dr()}var Yc=i('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-4.5"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M12 3l0 18"></path><path d="M12 9l4.65 -4.65"></path><path d="M12 14.3l7.37 -7.37"></path><path d="M12 19.6l8.85 -8.85"></path></svg> <span class="sr-only">Toggle theme</span>',1);function Xc(y){X(y,{variant:"ghost",size:"icon",class:"group/toggle extend-touch-target size-8",get onclick(){return On},title:"Toggle theme",children:(l,f)=>{var $=Yc();p(2),t(l,$)},$$slots:{default:!0}})}function Zc(){return[{title:"Introduction",href:"/docs",items:[]},{title:"Installation",href:"/docs/installation",items:[]},{title:"components.json",href:"/docs/components-json",items:[]},{title:"Theming",href:"/docs/theming",items:[]},{title:"Dark Mode",href:"/docs/dark-mode",items:[]},{title:"CLI",href:"/docs/cli",items:[]},{title:"JavaScript",href:"/docs/javascript",items:[]},{title:"Figma",href:"/docs/figma",items:[]},{title:"Changelog",href:"/docs/changelog",items:[]},{title:"Legacy Docs",href:"/docs/legacy",items:[]}]}const ho=["SvelteKit","Vite","Astro","Manual Installation"];function ev(){return[].sort((l,f)=>{const $=ho.indexOf(l.title),x=ho.indexOf(f.title);return $-x})}function tv(){return[]}function rv(){return[{title:"Svelte",href:"/docs/dark-mode/svelte",items:[]},{title:"Astro",href:"/docs/dark-mode/astro",items:[]}]}function av(){return[{title:"Registry",href:"/docs/registry",items:[]},{title:"Getting Started",href:"/docs/registry/getting-started",items:[]},{title:"FAQ",href:"/docs/registry/faq",items:[]},{title:"Examples",href:"/docs/registry/examples",items:[]},{title:"registry.json",href:"/docs/registry/registry-json",items:[]},{title:"registry-item.json",href:"/docs/registry/registry-item-json",items:[]}]}function sv(){return[]}const ov=Zc(),nv=sv(),lv=tv(),iv=ev(),dv=rv(),cv=av(),vv=[],Co=Bn(Po,y=>[{title:y("nav_reports"),href:"/reports"},{title:y("nav_pocs"),href:"/pocs"},{title:y("nav_docs"),href:"/docs"}]);function uv(){return[...ov,...nv,...lv,...iv.filter(y=>y.title!=="Installation"),...dv.filter(y=>y.title!=="Dark Mode"),...cv].map((y,l)=>({...y,index:l}))}uv();var fv=i("<a> </a>"),pv=i('<div class="relative flex h-8 w-4 items-center justify-center"><div class="relative size-4"><span></span> <span></span></div> <span class="sr-only">Toggle Menu</span></div> <span class="flex h-8 items-center text-lg leading-none font-medium"> </span>',1),_v=i('<div class="flex flex-col gap-4"><div class="text-sm font-medium text-muted-foreground"> </div> <div class="flex flex-col gap-3"></div></div>'),gv=i('<div class="flex flex-col gap-12 overflow-auto px-6 py-6"><div class="flex flex-col gap-4"><div class="text-sm font-medium text-muted-foreground"> </div> <div class="flex flex-col gap-3"><!> <!></div></div> <div class="flex flex-col gap-8"></div></div>'),mv=i("<!> <!>",1);function $v(y,l){ir(l,!0);const[f,$]=wo(),x=()=>Us(Po,"$t",f),C=()=>Us(Co,"$mainNavItems",f),T=(rr,$t)=>{let Dt=()=>$t?.().href,Lr=()=>$t?.().content,kr=()=>$t?.().class,Pe=()=>Fn($t?.(),["href","content","class"]);var Kt=fv(),Ve=()=>{c(u,!1)};Ua(Kt,cr=>({href:Dt(),onclick:Ve,class:cr,...Pe()}),[()=>wr("text-2xl font-medium",kr())]);var Ut=s(Kt,!0);a(Kt),P(()=>b(Ut,Lr())),t(rr,Kt)};let q=Er(l,["$$slots","$$events","$$legacy","class"]),u=L(!1);var Ye=E(),mt=d(Ye);o(mt,()=>Ya,(rr,$t)=>{$t(rr,{get open(){return e(u)},set open(Dt){c(u,Dt,!0)},children:(Dt,Lr)=>{var kr=mv(),Pe=d(kr);{const Ve=(Ut,cr)=>{let ar=()=>cr?.().props;{let Ht=j(()=>wr("extend-touch-target h-8 touch-manipulation items-center justify-start gap-2.5 !p-0 hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 active:bg-transparent dark:hover:bg-transparent",l.class));X(Ut,Pr(ar,()=>q,{variant:"ghost",get class(){return e(Ht)},children:(pe,vt)=>{var ze=pv(),ut=d(ze),Ct=s(ut),At=s(Ct),bt=r(At,2);a(Ct),p(2),a(ut);var lt=r(ut,2),er=s(lt,!0);a(lt),P((sr,yt,vr)=>{Rr(At,1,sr),Rr(bt,1,yt),b(er,vr)},[()=>fo(wr("absolute left-0 block h-0.5 w-4 bg-foreground transition-all duration-100",e(u)?"top-[0.4rem] -rotate-45":"top-1")),()=>fo(wr("absolute left-0 block h-0.5 w-4 bg-foreground transition-all duration-100",e(u)?"top-[0.4rem] rotate-45":"top-2.5")),()=>x()("nav_menu")]),t(pe,ze)},$$slots:{default:!0}}))}};o(Pe,()=>Ja,(Ut,cr)=>{cr(Ut,{child:Ve,$$slots:{child:!0}})})}var Kt=r(Pe,2);o(Kt,()=>Ka,(Ve,Ut)=>{Ut(Ve,{class:"no-scrollbar h-(--bits-popover-content-available-height) w-(--bits-popover-content-available-width) overflow-y-auto rounded-none border-none bg-background/90 p-0 shadow-none backdrop-blur duration-100",align:"start",side:"bottom",alignOffset:-16,sideOffset:14,preventScroll:!0,children:(cr,ar)=>{var Ht=gv(),pe=s(Ht),vt=s(pe),ze=s(vt,!0);a(vt);var ut=r(vt,2),Ct=s(ut);{let lt=j(()=>({href:"/",content:x()("nav_home")}));T(Ct,()=>e(lt))}var At=r(Ct,2);Zt(At,1,C,Qs,(lt,er)=>{T(lt,()=>({href:e(er).href,content:e(er).title}))}),a(ut),a(pe);var bt=r(pe,2);Zt(bt,21,()=>vv,lt=>lt.title,(lt,er)=>{var sr=_v(),yt=s(sr),vr=s(yt,!0);a(yt);var Pt=r(yt,2);Zt(Pt,21,()=>e(er).items,Qs,(Cr,Sr)=>{T(Cr,()=>({href:e(Sr).href,content:e(Sr).title}))}),a(Pt),a(sr),P(()=>b(vr,e(er).title)),t(lt,sr)}),a(bt),a(Ht),P(lt=>b(ze,lt),[()=>x()("nav_menu")]),t(cr,Ht)},$$slots:{default:!0}})}),t(Dt,kr)},$$slots:{default:!0}})}),t(y,Ye),dr(),$()}var hv=i('<span class="sr-only">Toggle layout</span> <!>',1);function xv(y,l){ir(l,!0);let f=Er(l,["$$slots","$$events","$$legacy","class"]);const $=Io.get();{let x=j(()=>wr("size-8",l.class));X(y,Pr({variant:"ghost",size:"icon",get class(){return e(x)},onclick:()=>{$.setConfig({layout:$.current.layout==="full"?"fixed":"full"})}},()=>f,{title:"Toggle layout",children:(C,T)=>{var q=hv(),u=r(d(q),2);Rn(u,{}),t(C,q)},$$slots:{default:!0}}))}dr()}function bv(y,l){ir(l,!0);let f=L(void 0);Ur(()=>Dn.subscribe(q=>{c(f,q??"zh",!0)}));const $=j(()=>e(f)==="zh"?"en":"zh"),x=j(()=>e($)==="en"?"EN":"中");function C(){const T=e($);if(ol(T),typeof window<"u")try{localStorage.setItem("lang",T),document?.documentElement?.setAttribute("lang",T)}catch{}}X(y,{variant:"ghost",size:"icon",class:"group/toggle extend-touch-target size-8",onclick:C,title:"Switch language",children:(T,q)=>{p();var u=m();P(()=>b(u,e(x))),t(T,u)},$$slots:{default:!0}}),dr()}var yv=i("<!> <span> </span>",1),Pv=i('<div class="flex flex-col gap-1 text-xs"><p> </p> <p> </p></div>'),wv=i("<!> <!>",1);function kv(y,l){ir(l,!1);let f=us(0),$=us(0),x,C=us(!0),T=us(!1),q=!0,u=0;function Ye(){return e(T)?Math.min(3e3*Math.pow(1.5,u),3e4):e(f)>50?2e3:5e3}async function mt(){if(!q)return;const Pe=new AbortController,Kt=setTimeout(()=>Pe.abort(),5e3);try{const Ve=await Nr.getServerInfo({signal:Pe.signal});clearTimeout(Kt),Ve.success&&Ve.data&&(c(f,Ve.data.cpu_usage||0),c($,Ve.data.memory_usage||0),c(C,!1),c(T,!1),u=0)}catch(Ve){Ve instanceof Error&&(Ve.name==="AbortError"||Ve.message==="timeout")||console.error("Failed to fetch server status",Ve),c(T,!0),u++}finally{q&&(x=setTimeout(mt,Ye()))}}function rr(){q=document.visibilityState==="visible",q?(x&&clearTimeout(x),mt()):x&&clearTimeout(x)}Hn(()=>{q=document.visibilityState==="visible",document.addEventListener("visibilitychange",rr),mt()}),Qn(()=>{typeof document<"u"&&document.removeEventListener("visibilitychange",rr),x&&clearTimeout(x)});function $t(Pe){return Pe<50?"border-transparent bg-green-500 text-white hover:bg-green-600":Pe<75?"border-transparent bg-yellow-500 text-white hover:bg-yellow-600":Pe<90?"border-transparent bg-orange-500 text-white hover:bg-orange-600":"border-transparent bg-red-500 text-white hover:bg-red-600"}Un();var Dt=E(),Lr=d(Dt);{var kr=Pe=>{$a(Pe,{children:(Kt,Ve)=>{var Ut=wv(),cr=d(Ut);ha(cr,{children:(Ht,pe)=>{{let vt=Gn(()=>$t(e(f)));fa(Ht,{variant:"outline",get class(){return`gap-1 transition-colors ${e(vt)??""}`},children:(ze,ut)=>{var Ct=yv(),At=d(Ct);qn(At,{class:"h-3.5 w-3.5"});var bt=r(At,2),lt=s(bt);a(bt),P(er=>b(lt,`${er??""}%`),[()=>e(f).toFixed(1)]),t(ze,Ct)},$$slots:{default:!0}})}},$$slots:{default:!0}});var ar=r(cr,2);xa(ar,{children:(Ht,pe)=>{var vt=Pv(),ze=s(vt),ut=s(ze);a(ze);var Ct=r(ze,2),At=s(Ct);a(Ct),a(vt),P((bt,lt)=>{b(ut,`CPU Usage: ${bt??""}%`),b(At,`Memory Usage: ${lt??""}%`)},[()=>e(f).toFixed(1),()=>e($).toFixed(1)]),t(Ht,vt)},$$slots:{default:!0}}),t(Kt,Ut)},$$slots:{default:!0}})};A(Lr,Pe=>{!e(C)&&!e(T)&&Pe(kr)})}t(y,Dt),dr()}var Sv=i('<!> <span class="sr-only">afrog security</span>',1),zv=i('<header class="sticky top-0 z-50 w-full bg-background"><div class="container-wrapper px-6 3xl:fixed:px-0"><div class="flex h-(--header-height) items-center gap-2 **:data-[slot=separator]:!h-4 3xl:fixed:container"><!> <!> <!> <div class="ml-auto flex items-center gap-2 md:flex-1 md:justify-end"><div class="w-full flex-1 items-center gap-2 md:flex md:w-auto md:flex-none"><div class="hidden md:block"><!></div> <!></div> <!> <!> <!> <!> <!> <!></div></div></div></header>');function Iv(y){const[l,f]=wo(),$=()=>Us(Co,"$mainNavItems",l);var x=zv(),C=s(x),T=s(C),q=s(T);$v(q,{class:"flex lg:hidden"});var u=r(q,2);X(u,{href:"/",variant:"ghost",size:"icon",class:"hidden size-8 lg:flex",children:(ar,Ht)=>{var pe=Sv(),vt=d(pe);al(vt,{class:"size-5"}),p(2),t(ar,pe)},$$slots:{default:!0}});var Ye=r(u,2);Gc(Ye,{get items(){return $()},class:"hidden lg:flex"});var mt=r(Ye,2),rr=s(mt),$t=s(rr),Dt=s($t);kv(Dt,{}),a($t);var Lr=r($t,2);bv(Lr,{}),a(rr);var kr=r(rr,2);Ds(kr,{orientation:"vertical",class:"ml-2 hidden lg:block"});var Pe=r(kr,2);Jc(Pe,{});var Kt=r(Pe,2);Ds(Kt,{orientation:"vertical",class:"hidden 3xl:flex"});var Ve=r(Kt,2);xv(Ve,{class:"hidden 3xl:flex"});var Ut=r(Ve,2);Ds(Ut,{orientation:"vertical"});var cr=r(Ut,2);Xc(cr),a(mt),a(T),a(C),a(x),t(y,x),f()}function Tv(y,l){ir(l,!0);let f=Er(l,["$$slots","$$events","$$legacy"]);Vn(y,Pr({get theme(){return Wn.current},class:"toaster group",style:"--normal-bg: var(--color-popover); --normal-text: var(--color-popover-foreground); --normal-border: var(--color-border);"},()=>f)),dr()}var Cv=i("<!> <!> <!> <!>",1),Av=i('<!> <!> <div class="relative z-10 flex h-svh flex-col overflow-hidden bg-background theme-container"><!> <!> <!></div>',1);function Vv(y,l){ir(l,!0),Ur(()=>{const{pathname:$t}=yo.url;console.log("pathname",$t),console.log("auth.authenticated",mo.authenticated),$t!=="/login"&&(mo.authenticated||Kn("/login",{replaceState:!0}))});const f=Io.set(new fl(l.data.userConfig)),$={light:"#ffffff",dark:"#09090b"},x=j(()=>[`layout-${f.current.layout}`,`theme-${f.current.activeTheme}`]);Jn.pre(()=>f.current.activeTheme,()=>{po(f.current.activeTheme)}),Ur(()=>{f.current.activeTheme!=="mono"&&(f.setConfig({activeTheme:"mono"}),po("mono"))});var C=Av(),T=d(C);{let $t=j(()=>["dark",...e(x)]),Dt=j(()=>["light",...e(x)]);Yn(T,{defaultMode:"system",disableTransitions:!0,get defaultTheme(){return f.current.activeTheme},get themeColors(){return $},get darkClassNames(){return e($t)},get lightClassNames(){return e(Dt)}})}var q=r(T,2);Tv(q,{position:"top-center"});var u=r(q,2),Ye=s(u);Iv(Ye);var mt=r(Ye,2);o(mt,()=>ja,($t,Dt)=>{Dt($t,{class:"flex flex-1",children:(Lr,kr)=>{var Pe=Cv(),Kt=d(Pe);o(Kt,()=>La,(ar,Ht)=>{Ht(ar,{class:"flex flex-1 flex-col",children:(pe,vt)=>{var ze=E(),ut=d(ze);ss(ut,()=>l.children),t(pe,ze)},$$slots:{default:!0}})});var Ve=r(Kt,2);o(Ve,()=>ya,(ar,Ht)=>{Ht(ar,{orientation:"vertical",children:(pe,vt)=>{var ze=E(),ut=d(ze);o(ut,()=>Pa,(Ct,At)=>{At(Ct,{})}),t(pe,ze)},$$slots:{default:!0}})});var Ut=r(Ve,2);o(Ut,()=>ya,(ar,Ht)=>{Ht(ar,{orientation:"horizontal",children:(pe,vt)=>{var ze=E(),ut=d(ze);o(ut,()=>Pa,(Ct,At)=>{At(Ct,{})}),t(pe,ze)},$$slots:{default:!0}})});var cr=r(Ut,2);o(cr,()=>Qa,(ar,Ht)=>{Ht(ar,{})}),t(Lr,Pe)},$$slots:{default:!0}})});var rr=r(mt,2);Uc(rr,{}),a(u),t(y,C),dr()}export{Vv as component,Gv as universal};
